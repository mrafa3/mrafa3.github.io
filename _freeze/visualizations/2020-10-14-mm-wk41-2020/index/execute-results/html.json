{
  "hash": "d8d9af2c614d7966c4fc306ee5bf480e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualizing responses to an analytics strategy survey\"\ndescription: \"Refreshing a style-forward graphic to improve understanding\"\nauthor:\n  - name: Mickey Rafa\n    url: https://mrafa3.github.io/\ndate: 10-14-2020\ncategories: [R, \"#MakeoverMonday\", bar-plot] # self-defined categories\nimage: \"mm_2020_41_thumbnail.png\"\ndraft: true # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n\neditor_options: \n  chunk_output_type: inline\n  \nexecute: \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n\n\n![Original graphic depicting the proportion of respondents to the dataIQ Analytics Strategy Adoption Survey.](mm_circular_plot.png){#fig-1}\n\n![Bar plot visualizing the composition of respondents from the dataIQ Analytics Strategy Adoption Survey. The financial services sector is highlighted.](mm_2020_41.png){#fig-2}\n\n# 1. Load Packages & Setup\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,\n    httr,\n    readxl,\n    sysfonts,\n    ggtext,\n    janitor,   #for clean_names()\n    scales,\n    glue,\n    here\n)\n\nfont_add_google(\"Montserrat\")\n```\n:::\n\n\n\n# 2. Read in the Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGET(\"https://query.data.world/s/vihrcc3hjn3umv2dy67iu2zxuyf2en\", write_disk(tf <- tempfile(fileext = \".xlsx\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nResponse [https://download.data.world/file_download/makeovermonday/2020w41-data-assets-and-data-culture/Book1.xlsx?auth=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwcm9kLXVzZXItY2xpZW50Om1yYWZhMyIsImlzcyI6ImFnZW50Om1yYWZhMzo6ODg0MjQ2ZDItMTgzMy00NmZjLTk2YTMtZjQ2MWMzMDJjOTZiIiwiaWF0IjoxNjAyNTI1NjIyLCJyb2xlIjpbInVzZXIiLCJ1c2VyX2FwaV9hZG1pbiIsInVzZXJfYXBpX3JlYWQiLCJ1c2VyX2FwaV93cml0ZSJdLCJnZW5lcmFsLXB1cnBvc2UiOmZhbHNlLCJ1cmwiOiI4NjdiNWU5MjcyM2U4NWEyY2I1ZGFhMzc1NzY2YzkyODY5ODM5Y2VhIn0.RuS7i_y0cGnKRPP1uTVAHZvRhsHkwkg5ExCuT0IKWSw3YrEbh36F7jROtavuinjPgy-pZTixSYm54OMrF1VHkw]\n  Date: 2024-12-11 21:21\n  Status: 200\n  Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\n  Size: 9.19 kB\n<ON DISK>  /var/folders/ck/dmgn8lbx6vl8sl89vlhr0sv00000gn/T//RtmpnrXB15/file8034c1643b3.xlsx\n```\n\n\n:::\n\n```{.r .cell-code}\ndf <- read_excel(tf) %>% \n  clean_names()\n```\n:::\n\n\n\n# 3. Examine the Data \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 16\nColumns: 2\n$ industry_sector     <chr> \"Other\", \"Travel and leisure\", \"Logistics\", \"Telec…\n$ respondents_percent <dbl> 10.9, 7.6, 2.2, 2.2, 13.0, 6.5, 8.7, 5.4, 3.3, 8.7…\n```\n\n\n:::\n:::\n\n\n\n# 4. Tidy the Data \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinancial_sector <- c('Financial services - other', \n                      'Financial services - insurance',\n                      'Financial services - banking')\n\ndf <- df %>% \n  mutate(financial_sector = \n           ifelse(industry_sector %in% financial_sector,\n                  'Financial', 'Other')) %>% \n  mutate(industry_sector_2 = ifelse(financial_sector == 'Financial', industry_sector, 'Other'))\n\nindustry_map <- df %>% \n  select(financial_sector, industry_sector_2)\n```\n:::\n\n\n\n# 5. Visualization Parameters \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmm_week <- 41\nmm_year <- 2020\n\nmy_theme <- theme(\n  text = element_text(family = 'Montserrat', size=12, color='black'), \n  plot.title = element_textbox(),\n  plot.subtitle = element_textbox(),\n  axis.ticks = element_blank(), \n  axis.title = element_blank(),\n  axis.text.x = element_blank(),\n  axis.text.y = element_text(size=14, margin = margin(r=-10)),\n  plot.background = element_rect(fill = 'white'),\n  panel.background =  element_blank(), \n  legend.background = element_blank(), \n  panel.grid.major = element_blank(),\n  panel.grid.minor = element_blank(),\n  panel.border = element_blank(), \n  legend.title=element_blank(), \n  legend.position = 'none')\n\nindustry_cols <- c('Financial' = 'darkorange2',\n                   'Other' = 'gray80')\n```\n:::\n\n\n\n# 6. Plot \n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrespondents_plot <- df %>% \n  ggplot(.,\n         aes(x=respondents_percent / 100,\n               y=reorder(industry_sector, respondents_percent))) + \n  geom_col(aes(fill=financial_sector)) + \n  geom_text(aes(x=respondents_percent / 100 + .01,\n                label=paste(respondents_percent, '%', sep=\"\")),\n            family='Montserrat', fontface='bold', size=7) + \n  annotate(\"text\", label=\"Makeover Monday\\nWeek 41 (2020)\", x=.11, y=2, family=\"Montserrat\", \n           size=7, lineheight=.9) + \n  labs(title='Responses to data and analytics strategy adoption survey by **dataIQ**',\n       subtitle=glue(\"Percent of respondents by industry, highlighting the <span style='color:darkorange2'>**financial sector**\")) + \n  scale_x_continuous(limits = c(0, .15),\n                     labels = percent) + \n  scale_fill_manual(values = industry_cols) + \n  my_theme + \n  theme(plot.title = element_textbox_simple(size=rel(2), margin = margin(b=5)),\n        plot.subtitle = element_textbox_simple(size=rel(1.35), margin = margin(b=5)),\n        axis.text = element_text(size=rel(1.4)))\n```\n:::\n\n\n# 7. Save \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Save the plot as PNG\nggsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}.png\"),\n  plot = respondents_plot,\n  width = 10, height = 6, units = \"in\", dpi = 320\n)\n\n# make thumbnail for page\nmagick::image_read(glue(\"mm_{mm_year}_{mm_week}.png\")) %>%\n  magick::image_resize(geometry = \"400\") %>%\n  magick::image_write(glue(\"mm_{mm_year}_{mm_week}_thumbnail.png\"))\n```\n:::\n\n\n\n# 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: America/Denver\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] here_1.0.1      glue_1.8.0      scales_1.3.0    janitor_2.2.0  \n [5] ggtext_0.1.2    sysfonts_0.8.9  readxl_1.4.3    httr_1.4.7     \n [9] lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    \n[13] purrr_1.0.2     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n[17] ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.4        generics_0.1.3    xml2_1.3.6        stringi_1.8.4    \n [5] hms_1.1.3         digest_0.6.37     magrittr_2.0.3    evaluate_1.0.1   \n [9] grid_4.4.0        timechange_0.3.0  fastmap_1.2.0     rprojroot_2.0.4  \n[13] cellranger_1.1.0  jsonlite_1.8.9    fansi_1.0.6       textshaping_0.4.0\n[17] cli_3.6.3         rlang_1.1.4       commonmark_1.9.2  munsell_0.5.1    \n[21] withr_3.0.1       yaml_2.3.10       tools_4.4.0       tzdb_0.4.0       \n[25] colorspace_2.1-1  curl_5.2.3        vctrs_0.6.5       R6_2.5.1         \n[29] magick_2.8.5      lifecycle_1.0.4   snakecase_0.11.1  htmlwidgets_1.6.4\n[33] ragg_1.3.3        pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.5     \n[37] Rcpp_1.0.13       systemfonts_1.1.0 xfun_0.48         tidyselect_1.2.1 \n[41] rstudioapi_0.17.1 knitr_1.48        farver_2.1.2      htmltools_0.5.8.1\n[45] labeling_0.4.3    rmarkdown_2.28    compiler_4.4.0    markdown_1.13    \n[49] gridtext_0.1.5   \n```\n\n\n:::\n:::\n\n\n:::\n\n# 9. Github Repository \n\n::: {.callout-tip collapse=\"true\"}\n\n##### Expand for GitHub Repo\n \n[Access the GitHub repository here](https://github.com/mrafa3/mrafa3.github.io)\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}