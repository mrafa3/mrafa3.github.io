{
  "hash": "596ed749d6aad3a981a433b1e4792bda",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Visualizing child marriage globally\"\ndescription: \"Making over a dashboard with a series of plots that tell the story of child marriage\"\nauthor:\n  - name: Mickey Rafa\n    url: https://mrafa3.github.io/\ndate: 10-12-2020\ncategories: [R, \"#MakeoverMonday\", bar-plot, connected-dot-plot, tile-map] # self-defined categories\nimage: \"mm_2020_39_tilemap_thumbnail.png\"\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\n\nformat:\n  html:\n    toc: true\n    toc-depth: 5\n    code-link: true\n    code-fold: true\n    code-tools: true\n    code-summary: \"Show code\"\n    self-contained: true\n\neditor_options: \n  chunk_output_type: inline\n  \nexecute: \n  error: false\n  message: false\n  warning: false\n  eval: true\n---\n\n\n\n\nEvery year, millions of children – mostly young girls – have their futures decided for them through child marriage. This isn't just about numbers in a dataset; it's about real kids losing their chance to grow, dream, and choose their own paths. While there has been progress, child marriage still happens too often, driven by from poverty and gender power dynamics in societies. Before I worked on this #MakeoverMonday, I wanted to recognize the humanity and pain in this data.\n\nHere's some more information from [UNICEF's website](https://www.unicef.org/protection/child-marriage):\n\n> Child marriage refers to any formal marriage or informal union between a child under the age of 18 and an adult or another child. Despite a steady decline in this harmful practice over the past decade, child marriage remains widespread, with approximately one in five girls married in childhood across the globe. Today, multiple crises – including conflict, climate shocks and the ongoing fallout from COVID-19 – are threatening to reverse progress towards eliminating this human rights violation. The United Nations Sustainable Development Goals call for global action to end child marriage by 2030.\n\nNow, here's the **original plot for #MakeoverMonday**\n\n![Original graphic depicting the rates of child marriage globally. Source: UNICEF](mm_child_marriage.png){#fig-1}\n\n**My alternative plots**\n\n![Bar plot visualizing the countries with the 10 highest rates of marriage among girls aged 15. Nine of the top 10 countries are in Africa. Source: UNICEF.](mm_2020_39_bar.png){#fig-2}\n\n![Dumbbell plot displaying the rates of child marriage among girls and boys. The countries shown are the 10 with the largest gender disparities -- where the marriage of girls is much higher than that of boys. Source: UNICEF.](mm_2020_39_dumbbell.png){#fig-3}\n\n![Stylized tile map showing the rate of marriage among girls aged 15. This type of map can be an effective way to communicate geographic patterns, while avoiding some shortcomings of typical map projections, like land area having large differences that can introduce cognitive biases. Source: UNICEF.](mm_2020_39_tilemap.png){#fig-4}\n\n# 1. Load Packages & Setup\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,\n    tidytuesdayR,\n    dlookr,\n    ggtext,\n    gt,\n    gtExtras,  #for font awesome icons in gt tables\n    ggbump,\n    ggalt,\n    hrbrthemes,\n    countrycode,\n    showtext,\n    janitor,   #for clean_names()\n    scales,\n    htmltools, #for tagList()\n    glue,\n    here,\n    geomtextpath\n)    \n\nfont_add_google('Lato')\n```\n:::\n\n\n\n\n# 2. Read in the Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmm_year <- 2020\nmm_week <- 39\n\ndf <- read.csv(\"https://query.data.world/s/qss24rzobvbkg6gc7y7lzfn75c4b46\",\n               header=TRUE, stringsAsFactors=FALSE) %>% \n  clean_names()\n\ntile_data <- read_csv(\"https://gist.githubusercontent.com/maartenzam/787498bbc07ae06b637447dbd430ea0a/raw/9a9dafafb44d8990f85243a9c7ca349acd3a0d07/worldtilegrid.csv\")\n```\n:::\n\n\n\n\n# 3. Examine the Data \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 128\nColumns: 4\n$ country               <chr> \"Afghanistan\", \"Albania\", \"Algeria\", \"Angola\", \"…\n$ females_married_by_15 <dbl> 0.04200000, 0.01400000, 0.00400000, 0.07900000, …\n$ females_married_by_18 <dbl> 0.2830000, 0.1180000, 0.0250000, 0.3030000, 0.05…\n$ males_married_by_18   <dbl> 0.073, 0.012, NA, 0.060, 0.004, 0.004, 0.044, NA…\n```\n\n\n:::\n\n```{.r .cell-code}\ndf %>% \n  summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   country          females_married_by_15 females_married_by_18\n Length:128         Min.   :0.00000       Min.   :0.0010       \n Class :character   1st Qu.:0.01150       1st Qu.:0.1115       \n Mode  :character   Median :0.03750       Median :0.2220       \n                    Mean   :0.05482       Mean   :0.2313       \n                    3rd Qu.:0.07750       3rd Qu.:0.3070       \n                    Max.   :0.29700       Max.   :0.7630       \n                                                               \n males_married_by_18\n Min.   :0.00000    \n 1st Qu.:0.01300    \n Median :0.03500    \n Mean   :0.04777    \n 3rd Qu.:0.06000    \n Max.   :0.27900    \n NA's   :33         \n```\n\n\n:::\n:::\n\n\n\n\n# 4. Tidy the Data \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# collect country codes and regions\ncodelist <- countrycode::codelist %>% \n  select(un.name.en, continent, \n         un.region.name, un.regionsub.name,\n         iso2c) %>% \n  rename(country = un.name.en) %>% \n  filter(!is.na(country))\n\n# adjust text of some names and join on codelist\ndf <- df %>% \n  mutate(country = recode(country,\n                          \"Cote d'Ivoire\" = \"Côte D'Ivoire\",\n                          \"Gambia\" = \"Gambia (Republic of The)\",\n                          \"Guinea-Bissau\" = \"Guinea Bissau\",\n                          \"Lao People's Democratic Republic\" = \"Lao People’s Democratic Republic\")) %>% \n  left_join(x=.,\n            y=codelist,\n            by='country')\n\n# Namibia is missing an `alpha.2` code, so correcting that\ntile_data <- tile_data %>% \n  mutate(alpha.2 = if_else(is.na(alpha.2), 'NA', alpha.2))\n\n# join tile_data with df\ntile_data <- tile_data %>% \n  left_join(x=.,\n            y=df,\n            by=c('alpha.2' = 'iso2c'))\n\n# create top 10 dataframes for vizzes\ntop_10_girls15_df <- df %>% \n  slice_max(order_by = females_married_by_15, \n            n =10) \n\ntop_10_disparity_df <- df %>% \n  mutate(diff_by_18 = females_married_by_18 - males_married_by_18) %>% \n  slice_max(order_by = diff_by_18, n = 10)\n```\n:::\n\n\n\n\n# 5. Visualization Parameters \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_theme <- theme(\n  text = element_text(family = 'Lato', size=12, color='black'), \n  axis.ticks = element_blank(), \n  plot.background = element_rect(color='white'),\n  panel.background =  element_blank(), \n  legend.background = element_blank(), \n  panel.grid.major = element_line(colour = \"grey90\", size = 0.5),\n  panel.grid.minor = element_line(colour = \"grey93\", size = 0.5),\n  panel.border = element_blank(), \n  legend.title=element_blank(), \n  legend.position = 'top')\n\nregion_cols <- c('Southern Asia' = 'darkorchid3',\n                 'Sub-Saharan Africa' = 'springgreen4')\n```\n:::\n\n\n\n\n# 6. Plot \n\n#### Bar plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop10_viz <- top_10_girls15_df %>% \n  ggplot(.,\n         aes(x=females_married_by_15,\n             y=reorder(country, females_married_by_15))) + \n  geom_col(aes(fill=un.regionsub.name)) +   \n  geom_text(aes(label=paste(round(females_married_by_15 * 100, 1), '%', sep = '')), \n          vjust=0.5, \n          size = 16, \n          position = position_stack(vjust = 0.5),\n          color='grey98',\n          fontface='bold') +\n  geom_text(aes(x = .002, label = country), \n            color = 'grey98', \n            hjust = 0, \n            vjust = 1,\n            size = 10,\n            fontface = 'bold') + \n  annotate(\"text\", \n           x=.3, y=1.25,\n           size=9, family=\"Lato\",\n           label = 'Makeover Monday Week 39 (2020)\\nData Source: UNICEF',\n           color='black',\n           lineheight=.3,\n           hjust = 1) + \n  scale_x_continuous(labels = percent) + \n  labs(x='',\n       y='',\n       title='Child marriage: a **human rights** issue that perpetuates **inequality**',\n       subtitle=glue(\"Worst countries all in <span style='color:springgreen4'>**Sub-Saharan Africa**</span> and <span style='color:darkorchid3'>**Sourthern Asia**</span><br>% of girls married by age 15\")) + \n  scale_fill_manual(values = region_cols) + \n  my_theme + \n  theme(legend.position = 'none',\n        plot.title = element_textbox(size=rel(5)),\n        plot.subtitle = element_textbox(size=rel(3.5), lineheight = .4),\n        plot.caption = element_textbox(size=rel(2), lineheight = .2),\n        axis.text = element_blank(),\n        axis.ticks = element_blank(), \n        panel.grid.minor = element_blank(),\n        panel.grid.major = element_blank())\n```\n:::\n\n\n\n\n#### Connected dot plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndisparity_viz <- top_10_disparity_df %>% \n  ggplot(.) + \n  geom_dumbbell(aes(x=males_married_by_18,\n                    xend=females_married_by_18,\n                    y=reorder(country, diff_by_18)),\n                size_x = 6,\n                size_xend = 6,\n                color = 'gray60', \n                colour_x = 'darkorchid3',\n                colour_xend = 'springgreen4') + \n  labs(x='<br>% of girls and boys married by age 18, arranged by the size of the gap<br>',\n       y='',\n       title=glue(\"Countries with wide **disparities** in rates of **youth marriage among <span style='color:darkorchid3'>boys</span> and <span style='color:springgreen4'>girls**</span>\"),\n       caption = \"10 countries with widest gender gap<br>Makeover Monday Week 39 (2020)<br>**Data Source**: UNICEF\") + \n  scale_x_continuous(labels = c('', '20%', '40%', '60%', '80%'),\n                     position = 'top') + \n  expand_limits(x=c(0, .85)) + \n  my_theme + \n  theme(panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        plot.title = element_textbox(size=rel(4.5), hjust = 0),\n        plot.title.position = 'plot',\n        plot.caption = element_textbox(size=rel(2), lineheight = .4),\n        axis.ticks = element_blank(),\n        axis.title = element_textbox(size=rel(2), lineheight = .4),\n        axis.text.x = element_text(size=rel(4)),\n        axis.text.y = element_text(size=rel(2.75)))\n```\n:::\n\n\n\n\n#### Tile map\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntilemap_viz <- tile_data %>% \n  ggplot(., \n         aes(xmin = x, ymin = y, xmax = x + 1, ymax = y + 1)) +\n  geom_rect(aes(fill=females_married_by_15), color = \"#ffffff\") + \n  geom_text(aes(x = x, y = y, label = alpha.2), \n            color = \"#ffffff\", alpha = 0.5, nudge_x = 0.5, nudge_y = -0.5, size = 3) + \n  labs(title='**Marriage rate of girls by 15 years old**',\n       subtitle='Makeover Monday Week 39 (2020)<br>**Data Source**: UNICEF<br>') + \n  scale_y_reverse() + \n  viridis::scale_fill_viridis(option = 'inferno', \n                              labels = scales::percent,\n                              na.value = \"gray90\") +\n  # theme_void() +\n  my_theme +\n  theme(plot.title = element_textbox(size=rel(7)),\n        plot.subtitle = element_textbox(size=rel(3), lineheight = .3),\n        plot.background = element_rect(color='white'), \n        legend.position = \"top\",\n        legend.direction = \"horizontal\",\n        legend.key.height = unit(0.3, \"cm\"),\n        legend.key.width = unit(2, \"cm\"),\n        legend.title.position = \"top\",\n        panel.grid.major = element_blank(),\n        panel.grid.minor = element_blank(),\n        axis.line = element_blank(),\n        axis.text = element_blank(),\n        axis.title = element_blank(),\n        legend.title = element_blank(),\n        legend.text = element_text(size=rel(3)), \n        legend.background = element_rect(fill = \"white\", color = NA),\n        legend.spacing.x = unit(0.2, 'cm'))\n```\n:::\n\n\n\n\n# 7. Save \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# TOP 10 PLOT\nggsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}_bar.png\"),\n  plot = top10_viz,\n  width = 8, height = 5, units = \"in\", dpi = 320\n)\n\n# DISPARITY PLOT\nggsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}_dumbbell.png\"),\n  plot = disparity_viz,\n  width = 8, height = 5, units = \"in\", dpi = 320\n)\n\n# TILE MAP\nggsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}_tilemap.png\"),\n  plot = tilemap_viz,\n  width = 6, height = 6, units = \"in\", dpi = 320\n)\n \n# make thumbnail for page\nmagick::image_read(glue(\"mm_{mm_year}_{mm_week}_bar.png\")) %>%\n  magick::image_resize(geometry = \"400\") %>%\n  magick::image_write(glue(\"mm_{mm_year}_{mm_week}_bar_thumbnail.png\"))\n\nmagick::image_read(glue(\"mm_{mm_year}_{mm_week}_dumbbell.png\")) %>% \n  magick::image_resize(geometry = \"400\") %>% \n  magick::image_write(glue(\"mm_{mm_year}_{mm_week}_dumbbell_thumbnail.png\"))\n\nmagick::image_read(glue(\"mm_{mm_year}_{mm_week}_tilemap.png\")) %>% \n  magick::image_resize(geometry = \"400\") %>% \n  magick::image_write(glue(\"mm_{mm_year}_{mm_week}_tilemap_thumbnail.png\"))\n```\n:::\n\n\n\n\n# 8. Session Info\n\n::: {.callout-tip collapse=\"true\"}\n##### Expand for Session Info\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: America/Denver\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] geomtextpath_0.1.4 here_1.0.1         glue_1.8.0         htmltools_0.5.8.1 \n [5] scales_1.3.0       janitor_2.2.0      showtext_0.9-7     showtextdb_3.0    \n [9] sysfonts_0.8.9     countrycode_1.6.0  hrbrthemes_0.8.7   ggalt_0.4.0       \n[13] ggbump_0.1.0       gtExtras_0.5.0     gt_0.11.1          ggtext_0.1.2      \n[17] dlookr_0.6.3       tidytuesdayR_1.1.2 lubridate_1.9.3    forcats_1.0.0     \n[21] stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2        readr_2.1.5       \n[25] tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1      tidyverse_2.0.0   \n[29] pacman_0.5.1      \n\nloaded via a namespace (and not attached):\n [1] gridExtra_2.3           rematch2_2.1.2          rlang_1.1.4            \n [4] magrittr_2.0.3          snakecase_0.11.1        compiler_4.4.0         \n [7] systemfonts_1.1.0       vctrs_0.6.5             maps_3.4.2             \n[10] pkgconfig_2.0.3         crayon_1.5.3            fastmap_1.2.0          \n[13] magick_2.8.5            fontawesome_0.5.2       labeling_0.4.3         \n[16] utf8_1.2.4              promises_1.3.0          rmarkdown_2.28         \n[19] markdown_1.13           tzdb_0.4.0              ragg_1.3.3             \n[22] bit_4.5.0               xfun_0.48               ash_1.0-15             \n[25] jsonlite_1.8.9          later_1.3.2             parallel_4.4.0         \n[28] R6_2.5.1                stringi_1.8.4           RColorBrewer_1.1-3     \n[31] pagedown_0.21           extrafontdb_1.0         Rcpp_1.0.13            \n[34] knitr_1.48              extrafont_0.19          httpuv_1.6.15          \n[37] timechange_0.3.0        tidyselect_1.2.1        rstudioapi_0.17.1      \n[40] yaml_2.3.10             viridis_0.6.5           curl_5.2.3             \n[43] shiny_1.9.1             withr_3.0.1             evaluate_1.0.1         \n[46] xml2_1.3.6              pillar_1.9.0            KernSmooth_2.23-24     \n[49] generics_0.1.3          vroom_1.6.5             rprojroot_2.0.4        \n[52] paletteer_1.6.0         hms_1.1.3               munsell_0.5.1          \n[55] commonmark_1.9.2        xtable_1.8-4            gdtools_0.4.0          \n[58] tools_4.4.0             reactable_0.4.4         grid_4.4.0             \n[61] Rttf2pt1_1.3.12         colorspace_2.1-1        cli_3.6.3              \n[64] kableExtra_1.4.0        textshaping_0.4.0       proj4_1.0-14           \n[67] fontBitstreamVera_0.1.1 fansi_1.0.6             viridisLite_0.4.2      \n[70] svglite_2.1.3           gtable_0.3.5            digest_0.6.37          \n[73] fontquiver_0.2.1        htmlwidgets_1.6.4       farver_2.1.2           \n[76] lifecycle_1.0.4         mime_0.12               fontLiberation_0.1.0   \n[79] gridtext_0.1.5          bit64_4.5.2             MASS_7.3-61            \n```\n\n\n:::\n:::\n\n\n\n:::\n\n# 9. Github Repository \n\n::: {.callout-tip collapse=\"true\"}\n\n##### Expand for GitHub Repo\n \n[Access the GitHub repository here](https://github.com/mrafa3/mrafa3.github.io)\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}