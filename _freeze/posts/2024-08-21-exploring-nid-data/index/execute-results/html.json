{
  "hash": "bd09331d7fbede1891f38303c69fa3cf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploring U.S. dams data from the National Inventory of Dams\"\ndescription: \"This post analyzes and visualizes data on dams in the U.S.\"\nauthor:\n  - name: Mickey Rafa\n    url: https://mrafa3.github.io/\n    #orcid: 0000-0002-5300-3075\ndate: 08-18-2024\ncategories: [R, tidyverse, duckdb, environment, sql, api] # self-defined categories\n#citation: \n # url: https://mrafa3.github.io/posts/2024-07-15-wikipedia-international-mens-soccer/ \n# image: query.png\ndraft: true # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n# Introduction\n\n\n# Data\n\n\n# Setup\n\n## Libraries \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(janitor)\n```\n:::\n\n\n## EDA\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 92401 Columns: 83\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (54): Dam Name, Other Names, Former Names, NID ID, Other Structure ID, ...\ndbl  (22): Number of Associated Structures, Latitude, Longitude, Distance to...\nlgl   (2): Length of Secondary Lock (Ft), Secondary Lock Width (Ft)\ndate  (5): Data Last Updated, Last Inspection Date, Condition Assessment Dat...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_dam %>% \n  mutate(state = as.factor(state),\n         state_regulated_dam = as.factor(state_regulated_dam))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 92,401 × 83\n   dam_name        other_names former_names nid_id other_structure_id federal_id\n   <chr>           <chr>       <chr>        <chr>  <chr>              <chr>     \n 1 Aichi Forge Us… Aichi Forg… <NA>         KY007… <NA>               KY00728   \n 2 Oxy Usa Retent… <NA>        <NA>         ND011… <NA>               ND01160   \n 3 Dod Usa 4       <NA>        Dod Usa      OK209… <NA>               OK20998   \n 4 Dod Usa 2       <NA>        Dod Usa      OK209… <NA>               OK20994   \n 5 Girl Scouts of… Lake Spart… <NA>         NC026… <NA>               NC02637   \n 6 Rlf/Pawnee Min… Pawnee Cap… Usa Coal Sl… IL500… <NA>               IL50006   \n 7 Exxonmobil Coa… Make-Up Wa… Monterey  C… IL505… <NA>               IL50526   \n 8 Exxonmobil Coa… <NA>        Monterey Co… IL505… <NA>               IL50527   \n 9 Rlf/Pawnee Min… Slurry Pon… Usa Coal Sl… IL504… <NA>               IL50416   \n10 Asso.Minerals … Associated… <NA>         FL001… <NA>               FL00155   \n# ℹ 92,391 more rows\n# ℹ 77 more variables: owner_names <chr>, owner_types <chr>,\n#   primary_owner_type <chr>, number_of_associated_structures <dbl>,\n#   is_associated_structure <chr>, designer_names <chr>,\n#   non_federal_dam_on_federal_property <chr>, primary_purpose <chr>,\n#   purposes <chr>, source_agency <chr>, state_or_federal_agency_id <chr>,\n#   latitude <dbl>, longitude <dbl>, state <fct>, county <chr>, city <chr>, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_dam %>% glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 92,401\nColumns: 83\n$ dam_name                                                  <chr> \"Aichi Forge…\n$ other_names                                               <chr> \"Aichi Forge…\n$ former_names                                              <chr> NA, NA, \"Dod…\n$ nid_id                                                    <chr> \"KY00728\", \"…\n$ other_structure_id                                        <chr> NA, NA, NA, …\n$ federal_id                                                <chr> \"KY00728\", \"…\n$ owner_names                                               <chr> \"AICHI\", \"OX…\n$ owner_types                                               <chr> \"Private\", \"…\n$ primary_owner_type                                        <chr> \"Private\", \"…\n$ number_of_associated_structures                           <dbl> 0, NA, 0, 0,…\n$ is_associated_structure                                   <chr> \"No\", \"No\", …\n$ designer_names                                            <chr> \"AUSTIN ENGI…\n$ non_federal_dam_on_federal_property                       <chr> NA, NA, \"No\"…\n$ primary_purpose                                           <chr> \"Other\", \"Ot…\n$ purposes                                                  <chr> \"Other\", \"Ot…\n$ source_agency                                             <chr> \"Kentucky\", …\n$ state_or_federal_agency_id                                <chr> \"KY00728\", N…\n$ latitude                                                  <dbl> 38.28828, 47…\n$ longitude                                                 <dbl> -84.55619, -…\n$ state                                                     <chr> \"Kentucky\", …\n$ county                                                    <chr> \"Scott\", \"Du…\n$ city                                                      <chr> \"DELAPLAIN-A…\n$ distance_to_nearest_city_miles                            <dbl> 1.0, NA, 1.0…\n$ river_or_stream_name                                      <chr> \"TR-DRY RUN\"…\n$ congressional_district                                    <chr> \"Kentucky, C…\n$ american_indian_alaska_native_native_hawaiian             <chr> NA, NA, \"Che…\n$ state_regulated_dam                                       <chr> \"Yes\", \"Yes\"…\n$ state_jurisdictional_dam                                  <chr> \"Yes\", \"Yes\"…\n$ state_regulatory_agency                                   <chr> \"KY Division…\n$ state_permitting_authority                                <chr> \"Yes\", \"Yes\"…\n$ state_inspection_authority                                <chr> \"Yes\", \"Yes\"…\n$ state_enforcement_authority                               <chr> \"Yes\", \"Yes\"…\n$ federally_regulated_dam                                   <chr> \"No\", \"No\", …\n$ federal_agency_owners                                     <chr> NA, NA, NA, …\n$ federal_agency_involvement_funding                        <chr> NA, NA, NA, …\n$ federal_agency_involvement_design                         <chr> NA, NA, NA, …\n$ federal_agency_involvement_construction                   <chr> NA, NA, NA, …\n$ federal_agency_involvement_regulatory                     <chr> NA, NA, NA, …\n$ federal_agency_involvement_inspection                     <chr> NA, NA, NA, …\n$ federal_agency_involvement_operation                      <chr> NA, NA, NA, …\n$ federal_agency_involvement_other                          <chr> NA, NA, NA, …\n$ built_under_the_authority_of_the_secretary_of_agriculture <chr> \"No\", \"No\", …\n$ nrcs_watershed_dam_authorization                          <chr> \"N/A\", \"N/A\"…\n$ primary_dam_type                                          <chr> \"Earth\", NA,…\n$ dam_types                                                 <chr> \"Earth\", NA,…\n$ core_types                                                <chr> NA, NA, \"Ear…\n$ foundation                                                <chr> NA, NA, \"Soi…\n$ dam_height_ft                                             <dbl> 15, 29, 15, …\n$ hydraulic_height_ft                                       <dbl> NA, NA, 12, …\n$ structural_height_ft                                      <dbl> NA, NA, 15, …\n$ nid_height_ft                                             <dbl> 15, 29, 15, …\n$ nid_height_category                                       <chr> \"Less than 2…\n$ dam_length_ft                                             <dbl> 325, NA, 240…\n$ volume_cubic_yards                                        <dbl> NA, NA, 0, 0…\n$ year_completed                                            <dbl> 1974, NA, 19…\n$ year_completed_category                                   <chr> \"1970-1979\",…\n$ years_modified                                            <chr> NA, NA, NA, …\n$ nid_storage_acre_ft                                       <dbl> 86.80, 682.6…\n$ max_storage_acre_ft                                       <dbl> 86.80, 682.6…\n$ normal_storage_acre_ft                                    <dbl> 26.6, NA, 25…\n$ surface_area_acres                                        <dbl> 8.0, NA, NA,…\n$ drainage_area_sq_miles                                    <dbl> 1.35, NA, NA…\n$ max_discharge_cubic_ft_second                             <dbl> NA, NA, 20, …\n$ spillway_type                                             <chr> \"Uncontrolle…\n$ spillway_width_ft                                         <dbl> NA, NA, 1, 1…\n$ number_of_locks                                           <dbl> NA, NA, 0, 0…\n$ length_of_locks_ft                                        <dbl> NA, NA, 0, 0…\n$ lock_width_ft                                             <dbl> NA, NA, 0, 0…\n$ length_of_secondary_lock_ft                               <lgl> NA, NA, NA, …\n$ secondary_lock_width_ft                                   <lgl> NA, NA, NA, …\n$ outlet_gate_type                                          <chr> NA, NA, \"Val…\n$ data_last_updated                                         <date> 2021-04-09,…\n$ last_inspection_date                                      <date> 2013-04-30,…\n$ inspection_frequency                                      <dbl> 5, NA, 5, 5,…\n$ hazard_potential_classification                           <chr> \"Low\", \"Low\"…\n$ condition_assessment                                      <chr> \"Not Rated\",…\n$ condition_assessment_date                                 <date> NA, NA, NA,…\n$ operational_status                                        <chr> NA, NA, NA, …\n$ operational_status_date                                   <date> NA, NA, NA,…\n$ eap_prepared                                              <chr> \"Not Require…\n$ eap_last_revision_date                                    <date> NA, NA, NA,…\n$ inundation_maps_added_to_nid                              <chr> \"No\", \"No\", …\n$ website_url                                               <chr> \"https://dam…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_dam %>% \n  group_by(owner_types) %>% \n  count() %>% \n  arrange(-n) %>% \n  ungroup() %>% \n  mutate(percent = round(100 * (n / sum(n)), 1))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 26 × 3\n   owner_types                  n percent\n   <chr>                    <int>   <dbl>\n 1 Private                  60445    65.4\n 2 Local Government         18390    19.9\n 3 State                     6658     7.2\n 4 Federal                   3436     3.7\n 5 Public Utility            1669     1.8\n 6 Not Listed                1380     1.5\n 7 State;Local Government     148     0.2\n 8 Local Government;Private   103     0.1\n 9 Private;Local Government    90     0.1\n10 Private;State               22     0  \n# ℹ 16 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## Setting up and querying DuckDB in R\n\n\n# Conclusion\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}