{
  "hash": "744cde2bb42a08ad1b284fc633d6447c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Exploring the CDC PLACES project\"\ndescription: \"This post shows how to fetch data from the CDC and analyze and map it simply\"\nauthor:\n  - name: Mickey Rafa\n    url: https://mrafa3.github.io/\n    #orcid: 0000-0002-5300-3075\ndate: 09-30-2024\ncategories: [R, data-viz, tidyverse, tidycensus, api, purrr] # self-defined categories\n#citation: \n # url: https://mrafa3.github.io/posts/2024-07-15-wikipedia-international-mens-soccer/ \n# image: co_county_pov_2022.png\ndraft: true # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\ncode-annotations: hover\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n\n# Introduction\n\nI saw a post recently about the Centers for Disease Control's Population Level Analysis and Community Estimates (or \"CDC PLACES\") project and its latest data release. The details of this project caught my attention, because it's a nation-wide project that measures and estimates key population health indicators, including metrics around prevention and the social determinants of health.[^1] Here is how the CDC describes it on their project website:\n\n> PLACES is a collaboration between CDC, the Robert Wood Johnson Foundation, and the CDC Foundation. PLACES provides health data for small areas across the country. This allows local health departments and jurisdictions, regardless of population size and rurality, to better understand the burden and geographic distribution of health measures in their areas and assist them in planning public health interventions.\n\n[^1]: Go to the CDC PLACES website for more details on the project and their methodology: https://www.cdc.gov/places/index.html \n\n## Purpose \n\nI found that there is a `CDCPLACES::` R package that facilitates API access to the project's data, so I wanted to explore what's available, and what it's like to fetch, analyze, and visualize data from the PLACES project.\n\nIn future posts, I plan to do a more formal analysis, but for now -- I wanted to get to know this package and the available data.\n\n## Setup and the `CDCPLACES::` package\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(CDCPLACES)\nlibrary(ggtext) # <1>\nlibrary(glue)\n```\n:::\n\n\n\n1. I use the `ggtext::element_textbox_simple()` function to bold some (but not all) text in a plot title. The `ggtext::` package has lots of neat functionality for ggplot graphics.\n\nThe `CDCPLACES::` package includes only two functions:\n\n*  `get_dictionary()`: shows indicators and some metadata for each indicator (measure name, release year, etc.)\n*  `get_places()`: fetches the data from the CDC PLACES API\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_dictionary() %>% head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  measureid                                  measure_full_name\n1 ARTHRITIS                             Arthritis among adults\n2    BPHIGH                   High blood pressure among adults\n3    CANCER         Cancer (non-skin) or melanoma among adults\n4   CASTHMA                        Current asthma among adults\n5       CHD                Coronary heart disease among adults\n6      COPD Chronic obstructive pulmonary disease among adults\n             measure_short_name categoryid   category_name places_release_2024\n1                     Arthritis    HLTHOUT Health Outcomes                2022\n2           High Blood Pressure    HLTHOUT Health Outcomes                2021\n3 Cancer (non-skin) or melanoma    HLTHOUT Health Outcomes                2022\n4                Current Asthma    HLTHOUT Health Outcomes                2022\n5        Coronary Heart Disease    HLTHOUT Health Outcomes                2022\n6                          COPD    HLTHOUT Health Outcomes                2022\n                                                    measurename16_23\n1                             Arthritis among adults aged >=18 years\n2                   High blood pressure among adults aged >=18 years\n3        Cancer (excluding skin cancer) among adults aged >=18 years\n4                        Current asthma among adults aged >=18 years\n5                Coronary heart disease among adults aged >=18 years\n6 Chronic obstructive pulmonary disease among adults aged >=18 years\n  places_release_2023 places_release_2022 places_release_2021\n1                2021                2020                2019\n2                2021                2019                2019\n3                2021                2020                2019\n4                2021                2020                2019\n5                2021                2020                2019\n6                2021                2020                2019\n  places_release_2020 _500_cities_release_2019 _500_cities_release_2018\n1                2018                     2017                     2016\n2                2017                     2017                     2015\n3                2018                     2017                     2016\n4                2018                     2017                     2016\n5                2018                     2017                     2016\n6                2018                     2017                     2016\n  _500_cities_release_2017 _500_cities_release_2016 frequency_brfss_year\n1                     2015                     2014                Every\n2                     2015                     2013                  Odd\n3                     2015                     2014                Every\n4                     2015                     2014                Every\n5                     2015                     2014                Every\n6                     2015                     2014                Every\n        shortname16_23\n1                 <NA>\n2                 <NA>\n3 Cancer (except skin)\n4                 <NA>\n5                 <NA>\n6                 <NA>\n```\n\n\n:::\n:::\n\n\n\nFrom the `get_dictionary()` function, you can see that there are 44 records (representing 44 different measures) from health outcomes, risk behaviors, status, prevention, disability, and health-related social needs (to preserve space, I'm only showing the top 6 records). It's a really exciting set of metrics for evaluating patterns of morbidity and health-related metrics (such as preventative metrics or the social determinants of health).\n\nWithin the `get_places()` function, there are the following arguments:\n\n*  **`geography=`**: argument that takes *county*, *census*, or *zcta*\n*  **`state=`**: takes in single state abbreviations (two-letter abbreviations), as well as vectors of multiple states\n*  **`measure=`**: code for the field(s) that you want to fetch (use `get_dictionary()`) for a complete list of measures)\n*  **`release=`**: takes in string for year of data that you want (available for years 2020-2023)\n*  **`geometry=`**: returns an `sf::` field that facilitates easy mapping (FALSE by default)\n*  **`cat=`**: instead of using the `measure=` argument, you can fetch entire categories of measures. \n*  **`age_adjust=`**: age adjustment is typically important for cross-regional/country comparisons. Age is a key determinant for risk of health conditions (e.g. older populations are more likely to experience dimentia). Adjusting for age differences across geographies can make for a more accurate comparison of prevalence.\n\n# Mapping data on depression in the U.S. among adults\n\nFor my initial exploration, I'd like to visualize depression among adults in the United States.  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_social_needs_depression <- get_places(geography = 'county',\n                       measure = 'DEPRESSION',\n                       release = '2024', # <2>\n                       geometry = TRUE) # <3>\n```\n:::\n\n\n\n2. Noting that the `release=` argument takes in a string for the year.\n3. By setting `geometry=TRUE`, you can then readily map the data using `geom_sf()`.\n\nThen, similar to the functionality of the `tidycensus::` package, you can quickly visualize the data with a `geom_sf()` call. When I'm mapping, I usually like to start with a color palette from the `viridis::` package, because they are generally good diverging palettes.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_social_needs_depression %>% \n  filter(data_value_type == 'Crude prevalence',\n         !stateabbr %in% c('AK', 'HI')) %>% \n  ggplot(.) + \n  geom_sf(aes(fill=data_value/100)) + \n  coord_sf(datum = NA) +\n  ggtitle('Depression among adults aged >= 18 years') + \n  scale_fill_viridis_c(option = 'magma',\n                       labels=scales::percent,\n                       name='') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/map1-1.png){width=672}\n:::\n:::\n\n\n\nThis map still has lots of work to do, but it's exciting to be able to access and visualize data from the CDC so easily. In my next `CDCPLACES::` post, I'll focus on improved styling of maps like this.\n\n## Social Needs -- a new category of data from the CDC PLACES project\n\nThe September 2024 release from CDC PLACES includes a new category of **social needs** measures, which include:\n\n*  Social isolation\n*  Food stamps \n*  Food insecurity\n*  Housing insecurity\n*  Utilities services threat\n*  Transportation barriers\n*  Lack of social/emotional support \n\nInstead of using the `measure=` argument (as I did above), I'll use the `cat=` argument to pull in all social needs indicators from the PLACES project.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_social_needs <- get_places(geography = 'county',\n                 cat = 'SOCLNEED',\n                 release = '2024',\n                 geometry = TRUE)\n```\n:::\n\n\n\nFor this first release of **social needs** indicators, there are only 39 states included.[^1]\n\n[^1]: At the time of this review, Arkansas, Colorado, Connecticut, Illinois, Louisiana, New York, North Dakota, Oregon, Pennsylvania, South Dakota, and Virginia are not included in the social needs indicators in CDCPLACES.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_social_needs %>% \n  filter(data_value_type == 'Crude prevalence',\n         measureid == 'FOODINSECU',\n         !stateabbr %in% c('AK', 'HI')) %>%\n  ggplot(.) + \n  geom_sf(aes(fill=data_value/100)) + \n  coord_sf(datum = NA) +\n  ggtitle('Food insecurity in the past 12 months among adults') +\n  scale_fill_viridis_c(option = 'magma',\n                       labels=scales::percent,\n                       name='') +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/map2-1.png){width=672}\n:::\n:::\n\n\n\nI also like to visualize the error bands associated with point estimates. The `geom_errorborh()` function comes in handy for that. I'll visualize the top 25 food insecure counties, along with their confidence intervals.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_social_needs %>% \n  filter(data_value_type == 'Crude prevalence',\n         measureid == 'FOODINSECU') %>% \n  top_n(25, data_value) %>% \n  ggplot(.,\n         aes(y=reorder(paste(locationname, statedesc, sep=\", \"), data_value),\n             color=if_else(statedesc == 'Texas', 'Texas', 'Other'))) + \n  geom_point(aes(x=data_value/100)) + \n  geom_errorbarh(aes(xmin=low_confidence_limit/100, \n                     xmax=high_confidence_limit/100), \n                 height = 0.4) +\n  ggtitle('% of adults experiencing **food insecurity** in the past 12 months',\n          subtitle = glue(\"<br>25 counties with the highest rates in 2024<br><span style='color:#cd2626'>**Texas**</span> has nine counties in the top 25\")) + \n  \n  labs(x='',\n       y='',\n       caption='Source: Centers for Disease Control PLACES project\\nPoint estimates and confidence intervals shown') + \n  scale_x_continuous(labels = scales::percent,\n                     position = 'top') + \n  scale_color_manual(values = c('Texas' = 'firebrick3',\n                                'Other' = 'black')) + \n  theme_minimal() + \n  theme(plot.title = element_textbox_simple(size=16),\n        plot.subtitle = element_textbox_simple(),\n        legend.position = 'none')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=768}\n:::\n:::\n\n\n\nAnd I'll visualize the food insecurity data from my home state, West Viriginia, where parts of central and southern West Virginia experience the highest rates of food insecurity in the state.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_social_needs %>% \n  filter(measureid == 'FOODINSECU',\n         statedesc == 'West Virginia') %>%\n  ggplot(.) + \n  geom_sf(aes(fill=data_value/100)) + \n  coord_sf(datum = NA) + \n  ggtitle('% of adults experiencing food insecurity in the last 12 months') +\n  scale_fill_viridis_c(option = 'magma',\n                       labels=scales::percent,\n                       name='') +\n  guides(color='none') + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n# Conclusion\n\nIn this post, I demonstrated how to fetch data from the `CDCPLACES::` package and visualize and map the results, using the `measure=` or `cat=` arguments. In future posts, I'll dig into more of the `CDCPLACES::` package. There's lots of interesting data available from this project. More soon!\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}