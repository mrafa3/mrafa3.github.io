[
  {
    "objectID": "visualizations.html",
    "href": "visualizations.html",
    "title": "Visualizations",
    "section": "",
    "text": "Analyzing relative password strength\n\n\n\nR\n\n\n#TidyTuesday\n\n\njitter-plot\n\n\n\nUsing a jitterplot to show the relative distribution of categories\n\n\n\nMickey Rafa\n\n\nDec 30, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing Big 12 Basketball program performance\n\n\n\nR\n\n\n#TidyTuesday\n\n\narea-plot\n\n\nsmall-multiples\n\n\n\nWhich teams have reigned supreme?\n\n\n\nMickey Rafa\n\n\nDec 30, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nU.S. National Parks Visits (1904-2016)\n\n\n\nR\n\n\n#TidyTuesday\n\n\nbump-chart\n\n\n\nEvaluating changes in the popularity of U.S. National Parks over time\n\n\n\nMickey Rafa\n\n\nDec 30, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing agricultural data using conditionally formatted tables\n\n\n\nR\n\n\n#TidyTuesday\n\n\ngt\n\n\n\nUsing the {gt} package to visualize data in tables\n\n\n\nMickey Rafa\n\n\nDec 30, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing Pell Grant Awards in the U.S. in 2017\n\n\n\nR\n\n\n#TidyTuesday\n\n\nline-plot\n\n\ngt\n\n\n\nExploring Colorado trends and the overall state-level Pell grant distribution\n\n\n\nMickey Rafa\n\n\nDec 30, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing enrollment in HBCUs by gender over time\n\n\n\nR\n\n\n#TidyTuesday\n\n\nline-plot\n\n\nribbon-plot\n\n\n\nWomen far outnumber men at HBCUs\n\n\n\nMickey Rafa\n\n\nDec 21, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing the expansion of wind turbine projects in Canada over time\n\n\n\nR\n\n\n#TidyTuesday\n\n\nline-plot\n\n\n\nShowing the major expansion in wind projects in Canada in the 2010s\n\n\n\nMickey Rafa\n\n\nOct 29, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing Anscombe’s Quartet\n\n\n\nR\n\n\n#TidyTuesday\n\n\nscatter-plot\n\n\n\nDifferent shapes can have similar summary statistics\n\n\n\nMickey Rafa\n\n\nOct 16, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing responses to an analytics strategy survey\n\n\n\nR\n\n\n#MakeoverMonday\n\n\nbar-plot\n\n\n\nRefreshing a style-forward graphic to improve understanding\n\n\n\nMickey Rafa\n\n\nOct 14, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing child marriage globally\n\n\n\nR\n\n\n#MakeoverMonday\n\n\nbar-plot\n\n\nconnected-dot-plot\n\n\ntile-map\n\n\n\nMaking over a dashboard with a series of plots that tell the story of child marriage\n\n\n\nMickey Rafa\n\n\nOct 12, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHow do Beyonce and Taylor Swift lyrics differ?\n\n\n\nR\n\n\n#TidyTuesday\n\n\nbar-plot\n\n\nnlp\n\n\n\nUsing {tidytext} to process and visualize word pairs in song lyrics\n\n\n\nMickey Rafa\n\n\nOct 4, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAnalyzing size distributions in the Palmer Penguins dataset\n\n\n\nR\n\n\n#TidyTuesday\n\n\nternary-plot\n\n\nridge-plot\n\n\n\nVisualizing distributions with some alternative chart types\n\n\n\nMickey Rafa\n\n\nSep 25, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing Australian climate data over time\n\n\n\nR\n\n\n#TidyTuesday\n\n\nline-plot\n\n\n\nPutting Australia’s extreme climate conditions in 2019 into historical context\n\n\n\nMickey Rafa\n\n\nSep 23, 2020\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVisualizing the Himalayas and expeditions over time\n\n\n\nR\n\n\n#TidyTuesday\n\n\nhistogram\n\n\nline-plot\n\n\n\nUsing data from the Himalayan Database to put the scope and expedition activity into perspective\n\n\n\nMickey Rafa\n\n\nSep 22, 2020\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts.html",
    "href": "posts.html",
    "title": "My Portfolio",
    "section": "",
    "text": "Creating great U.S. county maps with advanced ggplot styling\n\n\n\nR\n\n\ndata-viz\n\n\nmapping\n\n\ntidyverse\n\n\ncdcplaces\n\n\napi\n\n\n\nThis post shows how to make a beautiful U.S. map and create your own ggplot theme\n\n\n\nMickey Rafa\n\n\nOct 1, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nMapping depression and food insecurity in the U.S. with the CDC PLACES project\n\n\n\nR\n\n\ndata-viz\n\n\nmapping\n\n\ntidyverse\n\n\ncdcplaces\n\n\napi\n\n\n\nThis post shows how to fetch data from the CDC and analyze and map it simply\n\n\n\nMickey Rafa\n\n\nSep 30, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nReviewing the ACS-1 2023 child poverty estimates\n\n\n\nR\n\n\ndata-viz\n\n\ntidyverse\n\n\ntidycensus\n\n\napi\n\n\npurrr\n\n\n\nThis post looks at how child poverty estimates have changed in the latest U.S. Census data\n\n\n\nMickey Rafa\n\n\nSep 12, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAnalyzing CPI with Python and R\n\n\n\nPython\n\n\npandas\n\n\napi\n\n\ndata-viz\n\n\nplotnine\n\n\nR\n\n\nQuarto\n\n\nregression\n\n\nmatplotlib\n\n\n\nAccessing, analyzing, and visualizing data from the Federal Reserve\n\n\n\nMickey Rafa\n\n\nSep 11, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPart Three: Exploring even smaller geographies with tidycensus\n\n\n\nR\n\n\ntidyverse\n\n\ntidycensus\n\n\nmapping\n\n\napi\n\n\n\nThis post shows how to fetch data at smaller scales for analysis of Census data\n\n\n\nMickey Rafa\n\n\nAug 28, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPart Two: Wrangling Census data for longitudinal analysis of child poverty\n\n\n\nR\n\n\ndata-viz\n\n\ntidyverse\n\n\ntidycensus\n\n\napi\n\n\njavascript\n\n\npurrr\n\n\n\nThis post shows how to fetch many years of data simply, unlocking longitudinal analysis of Census data\n\n\n\nMickey Rafa\n\n\nAug 20, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSetting up an EPA air quality database using DuckDB\n\n\n\nR\n\n\ntidyverse\n\n\nduckdb\n\n\nenvironment\n\n\nsql\n\n\napi\n\n\n\nThis post uses the RAQSAPI package to access the EPA API and query the results with DuckDB\n\n\n\nMickey Rafa\n\n\nAug 18, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPart One: Exploring child poverty data with the tidycensus R package\n\n\n\nR\n\n\ntidyverse\n\n\nmapping\n\n\ngt\n\n\ntidycensus\n\n\napi\n\n\n\nThis post uses the tidycensus package to access the Census API and visualize data on child poverty in the U.S.\n\n\n\nMickey Rafa\n\n\nAug 13, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExploring interactive mapping with mapboxgl\n\n\n\nR\n\n\ntidyverse\n\n\nmapping\n\n\n\nThis post explores some mapboxgl features\n\n\n\nMickey Rafa\n\n\nAug 2, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBrainTree SQL challenge\n\n\n\nSQL\n\n\nQuarto\n\n\n\nThis post works through the SQL challenges used by PayPal\n\n\n\nMickey Rafa\n\n\nJul 30, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuery comparison: SQL, R, and Python using Chicago Employees dataset\n\n\n\nR\n\n\nSQL\n\n\nPython\n\n\nQuarto\n\n\ngenerative-AI\n\n\n\nThis post demonstrates how to run these languages in Quarto\n\n\n\nMickey Rafa\n\n\nJul 24, 2024\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nData Science Workflows in Javascript: Part Three\n\n\n\nQuarto\n\n\nJavascript\n\n\ndata-viz\n\n\npca\n\n\nenvironment\n\n\n\nThis post is from the third session led by Observable HQ\n\n\n\nMickey Rafa\n\n\nJul 29, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nData Science Workflows in Javascript: Part Two\n\n\n\nQuarto\n\n\nJavascript\n\n\ndata-viz\n\n\ncluster-analysis\n\n\nenvironment\n\n\n\nThis post is from the second session led by Observable HQ\n\n\n\nMickey Rafa\n\n\nJul 22, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nData Science Workflows in Javascript: Part One\n\n\n\nQuarto\n\n\nJavascript\n\n\ndata-viz\n\n\nregression\n\n\nenvironment\n\n\n\nThis post is from the first session led by Observable HQ\n\n\n\nMickey Rafa\n\n\nJul 11, 2023\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nBuilding beautiful tables with the gt:: package in R\n\n\n\nR\n\n\nweb-scraping\n\n\ngt\n\n\nsports\n\n\n\nThis post outlines how to quickly scrape and clean data from Wikipedia and build a beautiful table in R\n\n\n\nMickey Rafa\n\n\nDec 23, 2022\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPART TWO: Mapping of African Health Clusters\n\n\n\nR\n\n\ndata-viz\n\n\ntidyverse\n\n\ninternational-development\n\n\ncluster-analysis\n\n\nmapping\n\n\n\nCreating maps of cluster results using ggplot\n\n\n\nMickey Rafa\n\n\nJun 18, 2019\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPART ONE: Cluster Analysis of African Health Outcomes\n\n\n\nR\n\n\ndata-viz\n\n\ntidyverse\n\n\ninternational-development\n\n\ncluster-analysis\n\n\n\nExploring how African countries cluster based on their health outcomes\n\n\n\nMickey Rafa\n\n\nJun 18, 2019\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExperimenting with distance as a concept for SDG achievement\n\n\n\nR\n\n\ndata-viz\n\n\ntidyverse\n\n\ninternational-development\n\n\ncluster-analysis\n\n\nmapping\n\n\n\nExploring how to conceptualize and visualize distance from Sustainable Development Goal targets\n\n\n\nMickey Rafa\n\n\nApr 15, 2019\n\n\n\n\n\n\n\n\n\n\n\n\nAnimating the Gapminder dataset using gganimate\n\n\n\nR\n\n\ndata-viz\n\n\ntidyverse\n\n\ngganimate\n\n\n\nThis post outlines how to easily add animation to ggplot graphics\n\n\n\nMickey Rafa\n\n\nOct 15, 2017\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAnalysis of Gapminder data using nested models in R\n\n\n\nR\n\n\nregression\n\n\ndata-viz\n\n\ntidyverse\n\n\ninternational-development\n\n\n\nThis post outlines the value in building nested models using the purrr and broom packages\n\n\n\nMickey Rafa\n\n\nOct 1, 2017\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Mickey Rafa",
    "section": "",
    "text": "My name is Mickey – welcome to my portfolio website! I’m an analytics leader with nearly a decade of experience in high-growth environments, in both non-profit and for-profit organizations. I specialize in turning data into insights, improving the accessibility of dashboards and reports, and creating compelling data stories.\nOn this site, I include a selection of data science and viz projects that showcase the breadth of work that I’ve completed.\nLet’s connect! Feel free to reach out to me on LinkedIn or send me an email.\n\nEducation\n\nMS in Business Analytics | University of Denver\nMA in International Studies | University of Denver\nBA in Political Science | West Virginia University\n\nWork Experience\n\nStaff Analytics Engineer | Crisis Text Line\nSr. Manager, Employer Analytics | Guild Education\nAssistant Director of Research | Pardee Center for International Futures, University of Denver\n\nPeer-Reviewed Publications\n\nMoyer, J., Matthews, A., Rafa, M., Xiong, Y. “Identifying Patterns in the Structural Drivers of Intrastate Conflict.” British Journal of Political Science. (2022).\nWang, X., Rafa, M., Moyer, J., Li, J., Scheer, J., Sutton, P. “Estimation and Mapping of Sub-National GDP in Uganda Using NPP-VIIRS Imagery.” Remote Sensing. (2019)."
  },
  {
    "objectID": "visualizations/2020-10-14-mm-wk41-2020/index.html",
    "href": "visualizations/2020-10-14-mm-wk41-2020/index.html",
    "title": "Visualizing responses to an analytics strategy survey",
    "section": "",
    "text": "Figure 1: Original graphic depicting the proportion of respondents to the dataIQ Analytics Strategy Adoption Survey.\n\n\n\n\n\n\n\nFigure 2: Bar plot visualizing the composition of respondents from the dataIQ Analytics Strategy Adoption Survey. The financial services sector is highlighted.\n\n\n1. Load Packages & Setup\n\nShow codeif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,\n    httr,\n    readxl,\n    sysfonts,\n    ggtext,\n    janitor,   #for clean_names()\n    scales,\n    glue,\n    here\n)\n\nfont_add_google(\"Montserrat\")\n\n\n2. Read in the Data\n\nShow codeGET(\"https://query.data.world/s/vihrcc3hjn3umv2dy67iu2zxuyf2en\", write_disk(tf &lt;- tempfile(fileext = \".xlsx\")))\n\nResponse [https://download.data.world/file_download/makeovermonday/2020w41-data-assets-and-data-culture/Book1.xlsx?auth=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwcm9kLXVzZXItY2xpZW50Om1yYWZhMyIsImlzcyI6ImFnZW50Om1yYWZhMzo6ODg0MjQ2ZDItMTgzMy00NmZjLTk2YTMtZjQ2MWMzMDJjOTZiIiwiaWF0IjoxNjAyNTI1NjIyLCJyb2xlIjpbInVzZXIiLCJ1c2VyX2FwaV9hZG1pbiIsInVzZXJfYXBpX3JlYWQiLCJ1c2VyX2FwaV93cml0ZSJdLCJnZW5lcmFsLXB1cnBvc2UiOmZhbHNlLCJ1cmwiOiI4NjdiNWU5MjcyM2U4NWEyY2I1ZGFhMzc1NzY2YzkyODY5ODM5Y2VhIn0.RuS7i_y0cGnKRPP1uTVAHZvRhsHkwkg5ExCuT0IKWSw3YrEbh36F7jROtavuinjPgy-pZTixSYm54OMrF1VHkw]\n  Date: 2024-12-12 19:09\n  Status: 200\n  Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\n  Size: 9.19 kB\n&lt;ON DISK&gt;  /var/folders/ck/dmgn8lbx6vl8sl89vlhr0sv00000gn/T//RtmpCqT2p5/file41623c6cafd.xlsx\n\nShow codedf &lt;- read_excel(tf) %&gt;% \n  clean_names()\n\n\n3. Examine the Data\n\nShow codedf %&gt;% \n  glimpse()\n\nRows: 16\nColumns: 2\n$ industry_sector     &lt;chr&gt; \"Other\", \"Travel and leisure\", \"Logistics\", \"Telec…\n$ respondents_percent &lt;dbl&gt; 10.9, 7.6, 2.2, 2.2, 13.0, 6.5, 8.7, 5.4, 3.3, 8.7…\n\n\n4. Tidy the Data\n\nShow codefinancial_sector &lt;- c('Financial services - other', \n                      'Financial services - insurance',\n                      'Financial services - banking')\n\ndf &lt;- df %&gt;% \n  mutate(financial_sector = \n           ifelse(industry_sector %in% financial_sector,\n                  'Financial', 'Other')) %&gt;% \n  mutate(industry_sector_2 = ifelse(financial_sector == 'Financial', industry_sector, 'Other'))\n\nindustry_map &lt;- df %&gt;% \n  select(financial_sector, industry_sector_2)\n\n\n5. Visualization Parameters\n\nShow codemm_week &lt;- 41\nmm_year &lt;- 2020\n\nmy_theme &lt;- theme(\n  text = element_text(family = 'Montserrat', size=12, color='black'), \n  plot.title = element_textbox(),\n  plot.subtitle = element_textbox(),\n  axis.ticks = element_blank(), \n  axis.title = element_blank(),\n  axis.text.x = element_blank(),\n  axis.text.y = element_text(size=14, margin = margin(r=-10)),\n  plot.background = element_rect(fill = 'white'),\n  panel.background =  element_blank(), \n  legend.background = element_blank(), \n  panel.grid.major = element_blank(),\n  panel.grid.minor = element_blank(),\n  panel.border = element_blank(), \n  legend.title=element_blank(), \n  legend.position = 'none')\n\nindustry_cols &lt;- c('Financial' = 'darkorange2',\n                   'Other' = 'gray80')\n\n\n6. Plot\n\nShow coderespondents_plot &lt;- df %&gt;% \n  ggplot(.,\n         aes(x=respondents_percent / 100,\n               y=reorder(industry_sector, respondents_percent))) + \n  geom_col(aes(fill=financial_sector)) + \n  geom_text(aes(x=respondents_percent / 100 + .01,\n                label=paste(respondents_percent, '%', sep=\"\")),\n            family='Montserrat', fontface='bold', size=7) + \n  annotate(\"text\", label=\"Makeover Monday\\nWeek 41 (2020)\", x=.11, y=2, family=\"Montserrat\", \n           size=7, lineheight=.9) + \n  labs(title='Responses to data and analytics strategy adoption survey by **dataIQ**',\n       subtitle=glue(\"Percent of respondents by industry, highlighting the &lt;span style='color:darkorange2'&gt;**financial sector**\")) + \n  scale_x_continuous(limits = c(0, .15),\n                     labels = percent) + \n  scale_fill_manual(values = industry_cols) + \n  my_theme + \n  theme(plot.title = element_textbox_simple(size=rel(2), margin = margin(b=5)),\n        plot.subtitle = element_textbox_simple(size=rel(1.35), margin = margin(b=5)),\n        axis.text = element_text(size=rel(1.4)))\n\n\n7. Save\n\nShow code# Save the plot as PNG\nggsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}.png\"),\n  plot = respondents_plot,\n  width = 10, height = 6, units = \"in\", dpi = 320\n)\n\n# make thumbnail for page\nmagick::image_read(glue(\"mm_{mm_year}_{mm_week}.png\")) %&gt;%\n  magick::image_resize(geometry = \"400\") %&gt;%\n  magick::image_write(glue(\"mm_{mm_year}_{mm_week}_thumbnail.png\"))\n\n\n8. Session Info\n\n\n\n\n\n\nExpand for Session Info\n\n\n\n\n\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: America/Denver\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] here_1.0.1      glue_1.8.0      scales_1.3.0    janitor_2.2.0  \n [5] ggtext_0.1.2    sysfonts_0.8.9  readxl_1.4.3    httr_1.4.7     \n [9] lubridate_1.9.3 forcats_1.0.0   stringr_1.5.1   dplyr_1.1.4    \n[13] purrr_1.0.2     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n[17] ggplot2_3.5.1   tidyverse_2.0.0 pacman_0.5.1   \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.4        generics_0.1.3    xml2_1.3.6        stringi_1.8.4    \n [5] hms_1.1.3         digest_0.6.37     magrittr_2.0.3    evaluate_1.0.1   \n [9] grid_4.4.0        timechange_0.3.0  fastmap_1.2.0     rprojroot_2.0.4  \n[13] cellranger_1.1.0  jsonlite_1.8.9    fansi_1.0.6       textshaping_0.4.0\n[17] cli_3.6.3         rlang_1.1.4       commonmark_1.9.2  munsell_0.5.1    \n[21] withr_3.0.1       yaml_2.3.10       tools_4.4.0       tzdb_0.4.0       \n[25] colorspace_2.1-1  curl_5.2.3        vctrs_0.6.5       R6_2.5.1         \n[29] magick_2.8.5      lifecycle_1.0.4   snakecase_0.11.1  htmlwidgets_1.6.4\n[33] ragg_1.3.3        pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.5     \n[37] Rcpp_1.0.13       systemfonts_1.1.0 xfun_0.48         tidyselect_1.2.1 \n[41] rstudioapi_0.17.1 knitr_1.48        farver_2.1.2      htmltools_0.5.8.1\n[45] labeling_0.4.3    rmarkdown_2.28    compiler_4.4.0    markdown_1.13    \n[49] gridtext_0.1.5   \n\n\n\n\n\n9. Github Repository\n\n\n\n\n\n\nExpand for GitHub Repo\n\n\n\n\n\nAccess the GitHub repository here"
  },
  {
    "objectID": "visualizations/2024-12-12-mm-wk47-2024/index.html",
    "href": "visualizations/2024-12-12-mm-wk47-2024/index.html",
    "title": "Visualizing the prevalence and occurence of modern slavery globally",
    "section": "",
    "text": "Figure 1: Table illustrating the country-level prevalence and absolute estimates of modern slavery. Data source: Walk Free’s Global Slavery Index Report (2023).\n\n\n\n\n\n\n\nFigure 2: Bubble plot illustrating the country-level estimates of enslaved people. Bubble size corresponds with the estimated number of people in slavery in that country, and color corresponds to the geographic region. Data source: Walk Free’s Global Slavery Index Report (2023).\n\n\n\n\n\n\n\nFigure 3: Companion chart with Figure 2, showing the five countries in each region with the largest estimates of enslaved people. Data source: Walk Free’s Global Slavery Index Report (2023).\n\n\n1. Load Packages & Setup\n\nShow codeif (!require(\"pacman\")) install.packages(\"pacman\")\npacman::p_load(\n    tidyverse,\n    devtools,\n    httr,\n    readxl,\n    dlookr,\n    ggtext,\n    gt,\n    gtExtras,  #for font awesome icons in gt tables\n    ggbump,\n    ggcirclepack,\n    showtext,\n    tidycountries,\n    janitor,   #for clean_names()\n    scales,\n    patchwork,\n    htmltools, #for tagList()\n    glue,\n    here,\n    geomtextpath\n)  \n\n# install_github(\"EvaMaeRey/ggcirclepack\")\n\n\n2. Read in the Data\n\n\nResponse [https://download.data.world/file_download/makeovermonday/2024w47-global-slavery-index/MM%20W49%20-%20Global%20Slavery%20Index%202023.xlsx?auth=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwcm9kLXVzZXItY2xpZW50Om1yYWZhMyIsImlzcyI6ImFnZW50Om1yYWZhMzo6ODg0MjQ2ZDItMTgzMy00NmZjLTk2YTMtZjQ2MWMzMDJjOTZiIiwiaWF0IjoxNzM0MDE4Mzg5LCJyb2xlIjpbInVzZXIiLCJ1c2VyX2FwaV9hZG1pbiIsInVzZXJfYXBpX2VudGVycHJpc2VfYWRtaW4iLCJ1c2VyX2FwaV9yZWFkIiwidXNlcl9hcGlfd3JpdGUiXSwiZ2VuZXJhbC1wdXJwb3NlIjpmYWxzZSwidXJsIjoiNjI5OGY4ZmE0MDlkZTYxNTk5ZjFmM2M1Zjk4YjA1ZjVkYzcyZmE1ZCJ9.41u7KXt0E1E6-eg9iVwIiM5F-9nxsSrpPHJJnTtHXVoynnZWCU5kBr2b3B6OGXtBMjOkJXsDt4ybxJbSW5nn7g]\n  Date: 2024-12-13 17:56\n  Status: 200\n  Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\n  Size: 126 kB\n&lt;ON DISK&gt;  /var/folders/ck/dmgn8lbx6vl8sl89vlhr0sv00000gn/T//RtmpcB30MS/file737071737be.xlsx\n\n\n3. Examine the Data\n\n\n# A tibble: 17 × 6\n   variables        types missing_count missing_percent unique_count unique_rate\n   &lt;chr&gt;            &lt;chr&gt;         &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;\n 1 country          char…             0            0             180      1     \n 2 population       nume…             0            0             176      0.978 \n 3 region           char…             0            0               5      0.0278\n 4 estimated_preva… nume…            20           11.1           161      0.894 \n 5 estimated_numbe… nume…            20           11.1           118      0.656 \n 6 governance_issu… nume…            20           11.1           161      0.894 \n 7 lack_of_basic_n… nume…            20           11.1           161      0.894 \n 8 inequality_vuln… nume…            20           11.1           160      0.889 \n 9 disenfranchised… nume…            20           11.1           160      0.889 \n10 effects_of_conf… nume…            20           11.1           160      0.889 \n11 total_vulnerabi… nume…            20           11.1           161      0.894 \n12 survivors_of_sl… nume…             4            2.22           21      0.117 \n13 criminal_justic… nume…             4            2.22           19      0.106 \n14 coordination_oc… nume…             4            2.22            8      0.0444\n15 risk_factors_su… nume…             4            2.22           14      0.0778\n16 government_and_… nume…             4            2.22            5      0.0278\n17 government_resp… nume…             4            2.22           42      0.233 \n\n\n4. Tidy the Data\n\nShow codedf &lt;- df %&gt;% \n  mutate(country = case_match(country,\n                              'Türkiye' ~ 'Turkey',\n                              'United States of America' ~ 'United States',\n                              'Democratic Republic of the Congo' ~ 'DR Congo',\n                              'Viet Nam' ~ 'Vietnam',\n                              \"Côte d'Ivoire\" ~ 'Ivory Coast',\n                              'Lao PDR' ~ 'Laos',\n                              'Brunei Darussalam' ~ 'Brunei',\n                              .default = country),\n         percentile_nmbr_in_slavery = \n           round(100 * percent_rank(estimated_number_of_people_in_modern_slavery), 0),\n         rank_prevalence = rank(-estimated_prevalence_of_modern_slavery_per_1_000_population),\n         rank_absolute = round(rank(-estimated_number_of_people_in_modern_slavery), 0),\n         perc_ttl_nmbr_in_slavery = estimated_number_of_people_in_modern_slavery / sum(estimated_number_of_people_in_modern_slavery, na.rm=TRUE)) %&gt;% \n  left_join(x=.,\n            y=country_df,\n            by=c('country' = 'common_name'))\n\n\n5. Evaluate the Original Plot\n\n\n\n\n\nFigure 4: Original plot visualizing countries with the highest and lowest estimated prevalence of modern slavery. Source: Walk Free\n\n\nThis is an interesting dataset that reminds me of some work that I contributed to at the Pardee Center. There’s a lot that could be explored here, including things like mapping or analyzing the data with cluster analysis or PCA.\nI like a chart to display this information, but there’s some elements that I’ll reconsider:\n\nThe color encoding of prevalence rate has no meaning. It’s also odd/counterintuitive to use yellow for the countries with the highest prevalence and red for those with the lowest.\nThe chart titles aren’t clear as a standalone, and I typically prefer to make charts that can be lifted from reports while maintaining enough context to explain.\nThe number of people estimated to be in modern slavery is washed out by the prevalence rates. Yes, prevalence rate likely corresponds to the subtitle of the charts – countries with poor governance or high conflict zones are likely to have higher rates of slavery. But I couldn’t help but notice Japan’s estimate is very high, despite it being among the bottom 10 in prevalence rate. There could be something there to work on. Maybe adding a column for percentile rank of the number of people estimated to be in slavery conditions.\nSlicing this and show the top and bottom 10 by prevalence rate is an efficient use of space, but the distribution of prevalence rate is heavily skewed, which seems to make that approach less meaningful.\nI’d like to add the country flags to the table, because it’s a small design element that improves the recognition of some countries (at least for some). I have never used the {tidycountries} package, so I’ll give that a try.\n6. Visualization Parameters\n\nShow coderegion_cols &lt;- c('Asia and the Pacific' = \"#8dd3c7\",\n                 'Europe and Central Asia' = \"#ffffb3\",\n                 'Africa' = \"#bebada\",\n                 'Americas' = \"#fb8072\",\n                 'Arab States' = \"#80b1d3\")\n\nregion_cols_alpha &lt;- sapply(region_cols, alpha, alpha = 0.2)\n\nmy_theme &lt;- theme(\n  text = element_text(family = 'Lato', size=12, color='black'), \n  axis.ticks = element_blank(), \n  plot.background = element_rect(color='white'),\n  panel.background =  element_blank(), \n  legend.background = element_blank(), \n  panel.grid.major = element_blank(),\n  panel.grid.minor = element_blank(),\n  panel.border = element_blank(), \n  legend.title=element_blank(), \n  legend.position = 'none')\n\n\n7. Plot\n\nShow codegt_walk_free &lt;- df %&gt;% \n  select(flags_png, country, rank_prevalence, estimated_prevalence_of_modern_slavery_per_1_000_population, estimated_number_of_people_in_modern_slavery, percentile_nmbr_in_slavery) %&gt;%\n  arrange(rank_prevalence) %&gt;% \n  slice_max(n=25, estimated_prevalence_of_modern_slavery_per_1_000_population) %&gt;% \n  gt() %&gt;% \n  cols_label(country = '',\n             flags_png = '',\n             rank_prevalence = 'Rank (Prevalence)',\n             estimated_prevalence_of_modern_slavery_per_1_000_population = 'Prevalence Rate',\n             estimated_number_of_people_in_modern_slavery = '# of People (percentile rank)') %&gt;% \n  tab_header(title = md(\"**Countries with highest prevalence modern slavery from the&lt;br&gt;Global Slavery Index Report (2023)**\"),\n             subtitle = md(\"Prevalence defined as the estimated number of people in slavery per 1,000 population&lt;br&gt;&lt;br&gt;Highlighted rows indicate countries that are in the top 25% in terms of the number of people in slavery and includes many countries with relatively low prevalence rates, including South Korea, Argentina, Italy, and the United States\")) %&gt;% \n  tab_source_note(source_note = \"Estimates from Walk Free's Global Slavery Index Report (2023)\") %&gt;% \n  gt_merge_stack(col1 = estimated_number_of_people_in_modern_slavery, col2 = percentile_nmbr_in_slavery) %&gt;%\n  fmt_number(columns = estimated_number_of_people_in_modern_slavery,\n             decimals = 0) %&gt;% \n  fmt_number(columns = estimated_prevalence_of_modern_slavery_per_1_000_population,\n             decimals = 1) %&gt;% \n  gt_img_rows(\n    columns = flags_png,\n    height = 10\n  ) %&gt;% \n  gt_highlight_rows(\n    rows = percentile_nmbr_in_slavery &gt;= 75,# a logic statement\n    fill = \"gray90\",\n    bold_target_only = FALSE) %&gt;% \n  data_color(columns = estimated_prevalence_of_modern_slavery_per_1_000_population,\n             palette = c(\"white\", \"red\")) %&gt;%\n  gt_theme_538()\n\n\n\nShow codeplot_circlepack &lt;- df %&gt;% \n   filter(complete.cases(.)) %&gt;% \n   ggplot(., \n       aes(id=country, \n           area=estimated_number_of_people_in_modern_slavery,\n           fill=region)) +\n  ggcirclepack::geom_circlepack(linewidth = 1) +\n  ggcirclepack::geom_circlepack_text() + \n  coord_fixed() + \n  labs(title=glue(\"&lt;span style='color:#8dd3c7'&gt;**Asia and the Pacific**&lt;/span&gt; has an estimated **29 million people in slavery**\"),\n       subtitle='This constitutes nearly **60% of the global estimate** of people in slavery&lt;br&gt;**5 of the top 6 countries** are in the Asia and the Pacific region',\n       caption='**Source**: Walk Free&lt;br&gt;Global Slavery Index Report (2023)') + \n  scale_fill_manual(values = region_cols) + \n  my_theme + \n  theme(plot.title = element_textbox_simple(size=rel(3.4), margin = margin(t=20, b=10, l=-50),\n                                            lineheight = .4),\n        plot.subtitle = element_textbox(size=rel(2), margin = margin(l=-50), lineheight = .4),\n        plot.caption = element_textbox(size=rel(1.5), margin = margin(r=-10), lineheight = .4),\n        axis.text = element_blank())\n\n\n\nShow codegt_walk_free_region_top_5 &lt;- df %&gt;% \n  group_by(region) %&gt;% \n  slice_max(n=5, estimated_number_of_people_in_modern_slavery) %&gt;% \n  ungroup() %&gt;% \n  select(flags_png, country, region, estimated_number_of_people_in_modern_slavery, rank_absolute) %&gt;% \n  gt(groupname_col = 'region') %&gt;% \n  cols_label(country = '',\n             flags_png = '',\n             estimated_number_of_people_in_modern_slavery = '# of People',\n             rank_absolute = 'Global Rank') %&gt;% \n  tab_header(title = md(\"**Estimates of modern slavery by country from the Global Slavery Index**\"),\n             subtitle = \"Top 5 countries in each region shown\") %&gt;% \n  tab_source_note(source_note = \"Estimates from Walk Free's Global Slavery Index Report (2023)\") %&gt;% \n  # gt_merge_stack(col1 = estimated_number_of_people_in_modern_slavery, col2 = percentile_nmbr_in_slavery) %&gt;%\n  fmt_number(columns = estimated_number_of_people_in_modern_slavery,\n             decimals = 0) %&gt;% \n  gt_img_rows(\n    columns = flags_png,\n    height = 10\n  ) %&gt;% \n  data_color(columns = estimated_number_of_people_in_modern_slavery,\n             palette = c(\"white\", \"red\")) %&gt;%\n  tab_style(\n    style = list(\n      cell_fill(color = region_cols_alpha['Asia and the Pacific']),\n      cell_text(weight = \"bold\")\n    ),\n    locations = cells_row_groups(groups = \"Asia and the Pacific\")\n  ) %&gt;%\n  tab_style(\n    style = list(\n      cell_fill(color = region_cols_alpha['Europe and Central Asia']),\n      cell_text(weight = \"bold\")\n    ),\n    locations = cells_row_groups(groups = \"Europe and Central Asia\")\n  ) %&gt;%\n  tab_style(\n    style = list(\n      cell_fill(color = region_cols_alpha['Africa']),\n      cell_text(weight = \"bold\")\n    ),\n    locations = cells_row_groups(groups = \"Africa\")\n  ) %&gt;%\n  tab_style(\n    style = list(\n      cell_fill(color = region_cols_alpha['Americas']),\n      cell_text(weight = \"bold\")\n    ),\n    locations = cells_row_groups(groups = \"Americas\")\n  ) %&gt;%\n  tab_style(\n    style = list(\n      cell_fill(color = region_cols_alpha['Arab States']),\n      cell_text(weight = \"bold\")\n    ),\n    locations = cells_row_groups(groups = \"Arab States\")\n  ) %&gt;% \n  gt_theme_538()\n\n\n8. Save\n\nShow code# TOP 25 PREVALENCE TABLE\ngt_walk_free %&gt;% \n  gtsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}.png\"),\n  path = here::here('.//visualizations/2024-12-12-mm-wk47-2024/')\n)\n\n# CIRCLE PLOT\nggsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}_circlepack.png\"),\n  plot = plot_circlepack,\n  width = 4, height = 4, units = \"in\", dpi = 320\n)\n\n# TOP 5 BY REGION TABLE\ngt_walk_free_region_top_5 %&gt;% \n  gtsave(\n  filename = glue(\"mm_{mm_year}_{mm_week}_top5_by_region.png\"),\n  path = here::here('.//visualizations/2024-12-12-mm-wk47-2024/')\n)\n\n# make thumbnail for page\nmagick::image_read(glue(\"mm_{mm_year}_{mm_week}.png\")) %&gt;%\n  magick::image_resize(geometry = \"400\") %&gt;%\n  magick::image_write(glue(\"mm_{mm_year}_{mm_week}_thumbnail.png\"))\n\n\n9. Session Info\n\n\n\n\n\n\nExpand for Session Info\n\n\n\n\n\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-apple-darwin20\nRunning under: macOS Sonoma 14.6.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: America/Denver\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] geomtextpath_0.1.4      here_1.0.1              glue_1.8.0             \n [4] htmltools_0.5.8.1       patchwork_1.3.0         scales_1.3.0           \n [7] janitor_2.2.0           tidycountries_0.1.0     showtext_0.9-7         \n[10] showtextdb_3.0          sysfonts_0.8.9          ggcirclepack_0.0.0.9000\n[13] ggbump_0.1.0            gtExtras_0.5.0          gt_0.11.1              \n[16] ggtext_0.1.2            dlookr_0.6.3            readxl_1.4.3           \n[19] httr_1.4.7              devtools_2.4.5          usethis_3.0.0          \n[22] lubridate_1.9.3         forcats_1.0.0           stringr_1.5.1          \n[25] dplyr_1.1.4             purrr_1.0.2             readr_2.1.5            \n[28] tidyr_1.3.1             tibble_3.2.1            ggplot2_3.5.1          \n[31] tidyverse_2.0.0         pacman_0.5.1           \n\nloaded via a namespace (and not attached):\n  [1] rstudioapi_0.17.1       jsonlite_1.8.9          magrittr_2.0.3         \n  [4] magick_2.8.5            farver_2.1.2            rmarkdown_2.28         \n  [7] ragg_1.3.3              fs_1.6.4                vctrs_0.6.5            \n [10] memoise_2.0.1           paletteer_1.6.0         base64enc_0.1-3        \n [13] curl_5.2.3              cellranger_1.1.0        sass_0.4.9             \n [16] KernSmooth_2.23-24      htmlwidgets_1.6.4       fontawesome_0.5.2      \n [19] cachem_1.1.0            commonmark_1.9.2        mime_0.12              \n [22] lifecycle_1.0.4         pkgconfig_2.0.3         webshot2_0.1.1         \n [25] R6_2.5.1                fastmap_1.2.0           shiny_1.9.1            \n [28] snakecase_0.11.1        digest_0.6.37           colorspace_2.1-1       \n [31] rematch2_2.1.2          ps_1.8.0                rprojroot_2.0.4        \n [34] pkgload_1.4.0           textshaping_0.4.0       labeling_0.4.3         \n [37] fansi_1.0.6             timechange_0.3.0        compiler_4.4.0         \n [40] proxy_0.4-27            remotes_2.5.0           fontquiver_0.2.1       \n [43] withr_3.0.2             backports_1.5.0         DBI_1.2.3              \n [46] pkgbuild_1.4.4          Rttf2pt1_1.3.12         sessioninfo_1.2.2      \n [49] classInt_0.4-10         tools_4.4.0             chromote_0.3.1         \n [52] units_0.8-5             reactable_0.4.4         httpuv_1.6.15          \n [55] extrafontdb_1.0         promises_1.3.0          gridtext_0.1.5         \n [58] grid_4.4.0              sf_1.0-18               checkmate_2.3.2        \n [61] generics_0.1.3          gtable_0.3.6            tzdb_0.4.0             \n [64] class_7.3-22            websocket_1.4.2         hms_1.1.3              \n [67] xml2_1.3.6              utf8_1.2.4              pillar_1.9.0           \n [70] markdown_1.13           later_1.3.2             tidyselect_1.2.1       \n [73] pagedown_0.21           fontLiberation_0.1.0    miniUI_0.1.1.1         \n [76] knitr_1.48              fontBitstreamVera_0.1.1 gridExtra_2.3          \n [79] svglite_2.1.3           xfun_0.48               stringi_1.8.4          \n [82] yaml_2.3.10             kableExtra_1.4.0        evaluate_1.0.1         \n [85] extrafont_0.19          gdtools_0.4.0           packcircles_0.3.7      \n [88] cli_3.6.3               xtable_1.8-4            systemfonts_1.1.0      \n [91] munsell_0.5.1           processx_3.8.4          Rcpp_1.0.13-1          \n [94] ellipsis_0.3.2          profvis_0.4.0           urlchecker_1.0.1       \n [97] viridisLite_0.4.2       hrbrthemes_0.8.7        e1071_1.7-16           \n[100] rlang_1.1.4            \n\n\n\n\n\n10. Github Repository\n\n\n\n\n\n\nExpand for GitHub Repo\n\n\n\n\n\nAccess the GitHub repository here"
  }
]