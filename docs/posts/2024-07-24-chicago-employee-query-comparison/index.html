<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mickey Rafa">
<meta name="dcterms.date" content="2024-07-24">
<meta name="description" content="This post demonstrates how to run these languages in Quarto">

<title>Query comparison: SQL, R, and Python using Chicago Employees dataset</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Mickey Rafa</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../workshops.html"> 
<span class="menu-text">Workshops</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../visualizations.html"> 
<span class="menu-text">Visualizations</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Query comparison: SQL, R, and Python using Chicago Employees dataset</h1>
                  <div>
        <div class="description">
          This post demonstrates how to run these languages in Quarto
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">SQL</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Quarto</div>
                <div class="quarto-category">generative-AI</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://mrafa3.github.io/">Mickey Rafa</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 24, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#purpose" id="toc-purpose" class="nav-link" data-scroll-target="#purpose">Purpose</a></li>
  <li><a href="#setup-and-data-preparation" id="toc-setup-and-data-preparation" class="nav-link" data-scroll-target="#setup-and-data-preparation">Setup and data preparation</a></li>
  <li><a href="#setting-up-python-and-sql-to-execute" id="toc-setting-up-python-and-sql-to-execute" class="nav-link" data-scroll-target="#setting-up-python-and-sql-to-execute">Setting up Python and SQL to execute</a></li>
  </ul></li>
  <li><a href="#basic-selection-and-filtering" id="toc-basic-selection-and-filtering" class="nav-link" data-scroll-target="#basic-selection-and-filtering">1. Basic Selection and Filtering:</a></li>
  <li><a href="#aggregate-functions" id="toc-aggregate-functions" class="nav-link" data-scroll-target="#aggregate-functions">2. Aggregate Functions:</a></li>
  <li><a href="#grouping-and-sorting" id="toc-grouping-and-sorting" class="nav-link" data-scroll-target="#grouping-and-sorting">3. Grouping and Sorting:</a></li>
  <li><a href="#joining-and-subqueries" id="toc-joining-and-subqueries" class="nav-link" data-scroll-target="#joining-and-subqueries">4. Joining and Subqueries:</a></li>
  <li><a href="#complex-queries" id="toc-complex-queries" class="nav-link" data-scroll-target="#complex-queries">5. Complex Queries:</a></li>
  <li><a href="#own-questions" id="toc-own-questions" class="nav-link" data-scroll-target="#own-questions">6. Own Questions</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="purpose" class="level2">
<h2 class="anchored" data-anchor-id="purpose">Purpose</h2>
<p><strong>This project has three purposes</strong>:</p>
<ol type="1">
<li>To show how to run R, SQL, and Python all interchangeably in a Quarto document</li>
<li>To compare the ease of writing code using dplyr (R), SQL, and pandas (Python)</li>
<li>To include some demonstration of SQL in my portfolio (which is often not included but remains a critical skill)</li>
</ol>
</section>
<section id="setup-and-data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="setup-and-data-preparation">Setup and data preparation</h2>
<p><strong>Required packages</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)           <span class="co">#to fetch the data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)        <span class="co">#for the clean_names() function for data cleaning</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reticulate)     <span class="co">#to enable Python within R</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)            <span class="co">#to establish in-memory database of R dataframe</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)        <span class="co">#for SQLite engine</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)      <span class="co">#for functions to handle dates</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>About the dataset</strong>:</p>
<p>This dataset is from data.world, and includes information from Chicago’s Department of Human Resources for city employees in 2017. It’s a simple dataset to allow for comparisons across languages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reading as a temporary file, then saving as df</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">GET</span>(<span class="st">"https://query.data.world/s/hu5dkviuxd6k2ipuhpxjuyuds7aplu?dws=00000"</span>, <span class="fu">write_disk</span>(tf <span class="ot">&lt;-</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">".xls"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response [https://download.data.world/file_download/wbezchicago/chicago-employee-positions-and-salaries-for-2017/Employee%20Salary%20Data%20as%20of%20Sept.%202017.xls?auth=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwcm9kLXVzZXItY2xpZW50Om1yYWZhMyIsImlzcyI6ImFnZW50Om1yYWZhMzo6ODg0MjQ2ZDItMTgzMy00NmZjLTk2YTMtZjQ2MWMzMDJjOTZiIiwiaWF0IjoxNzIxODc0NzgyLCJyb2xlIjpbInVzZXIiLCJ1c2VyX2FwaV9hZG1pbiIsInVzZXJfYXBpX2VudGVycHJpc2VfYWRtaW4iLCJ1c2VyX2FwaV9yZWFkIiwidXNlcl9hcGlfd3JpdGUiXSwiZ2VuZXJhbC1wdXJwb3NlIjpmYWxzZSwidXJsIjoiMjM2ZDZlZGQ3NjdkZmVmOGRjYzM0Mzg3YTExMDQ1N2EzMmU1OGY3ZSJ9.oTr9PF0rrsLdVhewmy2v1vRgYvT0jy_PBmqhmrufaRSB25PEm48ZPxvswiSrZw8bNaACxDWpxwBiJVCVSaM-Zg]
  Date: 2024-11-07 20:59
  Status: 200
  Content-Type: application/vnd.ms-excel
  Size: 4.72 MB
&lt;ON DISK&gt;  /var/folders/ck/dmgn8lbx6vl8sl89vlhr0sv00000gn/T//RtmpkOuOtb/filed8ea1dd52f04.xls</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(tf) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#clean_names() to make all column names lowercase</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 32,806
Columns: 8
$ name                           &lt;chr&gt; "AARON,  JEFFERY M", "AARON,  KARINA", …
$ title                          &lt;chr&gt; "SERGEANT", "POLICE OFFICER (ASSIGNED A…
$ department                     &lt;chr&gt; "POLICE", "POLICE", "FLEET AND FACILITY…
$ salary_annual                  &lt;dbl&gt; 101442.0, 94122.0, 101592.0, 110064.0, …
$ original_hire_date             &lt;dttm&gt; 2005-09-26, 2005-09-26, 1991-08-01, 19…
$ start_date_in_present_position &lt;dttm&gt; 2016-06-01, 2017-04-16, 2000-05-01, 20…
$ salary_basis                   &lt;chr&gt; "SALARY", "SALARY", "SALARY", "SALARY",…
$ employment_category            &lt;chr&gt; "Fulltime-Regular", "Fulltime-Regular",…</code></pre>
</div>
</div>
</section>
<section id="setting-up-python-and-sql-to-execute" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-python-and-sql-to-execute">Setting up Python and SQL to execute</h2>
<p>The <code>DBI::</code> package allows you to create an in-memory database to query against. The <a href="https://r-dbi.org/">DBI project site</a> is a great place to learn more about it. I’ll start by doing some initial setup and establishing the connection between the R dataframe and the SQL table name that I’ll query.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(<span class="fu">SQLite</span>(), <span class="st">":memory:"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>DBI<span class="sc">::</span><span class="fu">dbWriteTable</span>(<span class="at">conn =</span> con, <span class="at">name =</span> <span class="st">"df"</span>, <span class="at">value =</span> df, <span class="at">field.types =</span> <span class="fu">c</span>(<span class="st">"original_hire_date"</span> <span class="ot">=</span> <span class="st">"Date"</span>), <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>reticulate::</code> package allows for executing Python code in an R environment. The <a href="https://rstudio.github.io/reticulate/">reticulate project site</a> includes useful examples for getting up and running with Python in R. This package includes an <code>r_to_py()</code> function that is needed to convert an R dataframe into a pandas dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>py<span class="sc">$</span>df <span class="ot">&lt;-</span> <span class="fu">r_to_py</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When inserting a code chunk to your Markdown file, it originally defaults to ‘{r}’. You can simply change this to ‘python’ or ‘sql’ and, with the above set up, the code works beautifully in a Quarto document!</p>
<p>In the sections that follow, I used ChatGPT to generate prompts as querying exercises. For the initial code chunks,</p>
</section>
</section>
<section id="basic-selection-and-filtering" class="level1">
<h1>1. Basic Selection and Filtering:</h1>
<p><strong>Retrieve all records of employees who have the job title “POLICE OFFICER”.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> title <span class="op">=</span> <span class="st">'POLICE OFFICER'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 21%">
<col style="width: 8%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">department</th>
<th style="text-align: right;">salary_annual</th>
<th style="text-align: right;">original_hire_date</th>
<th style="text-align: right;">start_date_in_present_position</th>
<th style="text-align: left;">salary_basis</th>
<th style="text-align: left;">employment_category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ABBATE, TERRY M</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">93354</td>
<td style="text-align: right;">818035200</td>
<td style="text-align: right;">818035200</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABDALLAH, ZAID</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">84054</td>
<td style="text-align: right;">1354233600</td>
<td style="text-align: right;">1354233600</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABDELHADI, ABDALMAHD</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">87006</td>
<td style="text-align: right;">1166400000</td>
<td style="text-align: right;">1166400000</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABDELMAJEID, AZIZ</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">84054</td>
<td style="text-align: right;">1209340800</td>
<td style="text-align: right;">1209340800</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABEJERO, JASON V</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">90024</td>
<td style="text-align: right;">940809600</td>
<td style="text-align: right;">940809600</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABFALL, RICHARD C</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">48078</td>
<td style="text-align: right;">1494892800</td>
<td style="text-align: right;">1494892800</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABNEY, PATRICK</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">72510</td>
<td style="text-align: right;">1435536000</td>
<td style="text-align: right;">1435536000</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABOUASSI, CHADI</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">48078</td>
<td style="text-align: right;">1494892800</td>
<td style="text-align: right;">1494892800</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABRAHAM, NANCY A</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">76266</td>
<td style="text-align: right;">1398643200</td>
<td style="text-align: right;">1398643200</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABRAM, ANTHONY A</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">68616</td>
<td style="text-align: right;">1466985600</td>
<td style="text-align: right;">1466985600</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">==</span> <span class="st">'POLICE OFFICER'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,213 × 8
   name                  title      department salary_annual original_hire_date 
   &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;              &lt;dbl&gt; &lt;dttm&gt;             
 1 ABBATE,  TERRY M      POLICE OF… POLICE             93354 1995-12-04 00:00:00
 2 ABDALLAH,  ZAID       POLICE OF… POLICE             84054 2012-11-30 00:00:00
 3 ABDELHADI,  ABDALMAHD POLICE OF… POLICE             87006 2006-12-18 00:00:00
 4 ABDELMAJEID,  AZIZ    POLICE OF… POLICE             84054 2008-04-28 00:00:00
 5 ABEJERO,  JASON V     POLICE OF… POLICE             90024 1999-10-25 00:00:00
 6 ABFALL,  RICHARD C    POLICE OF… POLICE             48078 2017-05-16 00:00:00
 7 ABNEY,  PATRICK       POLICE OF… POLICE             72510 2015-06-29 00:00:00
 8 ABOUASSI,  CHADI      POLICE OF… POLICE             48078 2017-05-16 00:00:00
 9 ABRAHAM,  NANCY A     POLICE OF… POLICE             76266 2014-04-28 00:00:00
10 ABRAM,  ANTHONY A     POLICE OF… POLICE             68616 2016-06-27 00:00:00
# ℹ 9,203 more rows
# ℹ 3 more variables: start_date_in_present_position &lt;dttm&gt;,
#   salary_basis &lt;chr&gt;, employment_category &lt;chr&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">'title'</span>] <span class="op">==</span> <span class="st">'POLICE OFFICER'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        name           title  ... salary_basis  employment_category
10          ABBATE,  TERRY M  POLICE OFFICER  ...       SALARY     Fulltime-Regular
12           ABDALLAH,  ZAID  POLICE OFFICER  ...       SALARY     Fulltime-Regular
13     ABDELHADI,  ABDALMAHD  POLICE OFFICER  ...       SALARY     Fulltime-Regular
15        ABDELMAJEID,  AZIZ  POLICE OFFICER  ...       SALARY     Fulltime-Regular
24         ABEJERO,  JASON V  POLICE OFFICER  ...       SALARY     Fulltime-Regular
...                      ...             ...  ...          ...                  ...
32800        ZYGMUNT,  DAWID  POLICE OFFICER  ...       SALARY     Fulltime-Regular
32801   ZYLINSKA,  KATARZYNA  POLICE OFFICER  ...       SALARY     Fulltime-Regular
32802     ZYMANTAS,  LAURA C  POLICE OFFICER  ...       SALARY     Fulltime-Regular
32803      ZYMANTAS,  MARK E  POLICE OFFICER  ...       SALARY     Fulltime-Regular
32804    ZYRKOWSKI,  CARLO E  POLICE OFFICER  ...       SALARY     Fulltime-Regular

[9213 rows x 8 columns]</code></pre>
</div>
</div>
<p><strong>List the names and salaries of employees whose annual salary is greater than $100,000.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> name, salary_annual</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> salary_annual <span class="op">&gt;</span> <span class="dv">100000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">salary_annual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AARON, JEFFERY M</td>
<td style="text-align: right;">101442</td>
</tr>
<tr class="even">
<td style="text-align: left;">AARON, KIMBERLEI R</td>
<td style="text-align: right;">101592</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABAD JR, VICENTE M</td>
<td style="text-align: right;">110064</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABBATEMARCO, JAMES J</td>
<td style="text-align: right;">103350</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABDELLATIF, AREF R</td>
<td style="text-align: right;">102228</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABDUL-KARIM, MUHAMMAD A</td>
<td style="text-align: right;">111492</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABDULLAH, KEVIN</td>
<td style="text-align: right;">114846</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABOUELKHEIR, HASSAN A</td>
<td style="text-align: right;">110064</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ABRAHAM, GIRLEY T</td>
<td style="text-align: right;">110064</td>
</tr>
<tr class="even">
<td style="text-align: left;">ABRAMSKI, JOHN E</td>
<td style="text-align: right;">128970</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(salary_annual <span class="sc">&gt;</span> <span class="dv">100000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, salary_annual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,091 × 2
   name                     salary_annual
   &lt;chr&gt;                            &lt;dbl&gt;
 1 AARON,  JEFFERY M               101442
 2 AARON,  KIMBERLEI R             101592
 3 ABAD JR,  VICENTE M             110064
 4 ABBATEMARCO,  JAMES J           103350
 5 ABDELLATIF,  AREF R             102228
 6 ABDUL-KARIM,  MUHAMMAD A        111492
 7 ABDULLAH,  KEVIN                114846
 8 ABOUELKHEIR,  HASSAN A          110064
 9 ABRAHAM,  GIRLEY T              110064
10 ABRAMSKI,  JOHN E               128970
# ℹ 6,081 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">'salary_annual'</span>] <span class="op">&gt;</span> <span class="dv">100000</span>][[<span class="st">'name'</span>, <span class="st">'salary_annual'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        name  salary_annual
0          AARON,  JEFFERY M       101442.0
2        AARON,  KIMBERLEI R       101592.0
3        ABAD JR,  VICENTE M       110064.0
9      ABBATEMARCO,  JAMES J       103350.0
14       ABDELLATIF,  AREF R       102228.0
...                      ...            ...
32783         ZUPAN,  BILL M       114324.0
32785     ZURAWSKI,  JEFFREY       101608.0
32794    ZWOLFER,  MATTHEW W       114324.0
32798    ZYGADLO,  MICHAEL J       101608.0
32805    ZYSKOWSKI,  DARIUSZ       115932.0

[6091 rows x 2 columns]</code></pre>
</div>
</div>
<p><strong>Find all employees who work in the “FINANCE” department.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> name</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> department <span class="op">=</span> <span class="st">'FINANCE'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ADAMCZYK JR, JAN</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADAPON, NENITA P</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ADENI, MOHAMED K</td>
</tr>
<tr class="even">
<td style="text-align: left;">AHMED, MOHAMMAD A</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AIKONEDO, PAUL E</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALAM, SYED S</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALEXANDER, PATRICIA L</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALEXANDER, RACQUEL L</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ALLEN, JONATHAN E</td>
</tr>
<tr class="even">
<td style="text-align: left;">ALLEN, KEVIN M</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(department <span class="sc">==</span> <span class="st">'FINANCE'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 563 × 1
   name                  
   &lt;chr&gt;                 
 1 ADAMCZYK JR,  JAN     
 2 ADAPON,  NENITA P     
 3 ADENI,  MOHAMED K     
 4 AHMED,  MOHAMMAD A    
 5 AIKONEDO,  PAUL E     
 6 ALAM,  SYED S         
 7 ALEXANDER,  PATRICIA L
 8 ALEXANDER,  RACQUEL L 
 9 ALLEN,  JONATHAN E    
10 ALLEN,  KEVIN M       
# ℹ 553 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">'department'</span>] <span class="op">==</span> <span class="st">'FINANCE'</span>][<span class="st">'name'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>109         ADAMCZYK JR,  JAN
162         ADAPON,  NENITA P
175         ADENI,  MOHAMED K
263        AHMED,  MOHAMMAD A
278         AIKONEDO,  PAUL E
                 ...         
32498    ZACARIAZ,  ALEJANDRO
32522          ZAIDI,  SYED K
32605       ZAVALA,  FERNANDO
32680          ZHANG,  KEFENG
32789          ZUREK,  MARY H
Name: name, Length: 563, dtype: object</code></pre>
</div>
</div>
</section>
<section id="aggregate-functions" class="level1">
<h1>2. Aggregate Functions:</h1>
<p><strong>Calculate the average salary for all employees.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">avg</span>(salary_annual)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">avg(salary_annual)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">81631.46</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(salary_annual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `mean(salary_annual)`
                  &lt;dbl&gt;
1                81631.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'salary_annual'</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>np.float64(81631.4588758154)</code></pre>
</div>
</div>
<p><strong>Find the total number of employees in each department.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> department, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> ttl_employees</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> department</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> ttl_employees <span class="kw">desc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">department</th>
<th style="text-align: right;">ttl_employees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">13055</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIRE</td>
<td style="text-align: right;">4833</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OEMC</td>
<td style="text-align: right;">2121</td>
</tr>
<tr class="even">
<td style="text-align: left;">STREETS &amp; SAN</td>
<td style="text-align: right;">2045</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WATER MGMNT</td>
<td style="text-align: right;">1902</td>
</tr>
<tr class="even">
<td style="text-align: left;">AVIATION</td>
<td style="text-align: right;">1414</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRANSPORTN</td>
<td style="text-align: right;">1244</td>
</tr>
<tr class="even">
<td style="text-align: left;">PUBLIC LIBRARY</td>
<td style="text-align: right;">978</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FLEET AND FACILITY MGMT</td>
<td style="text-align: right;">964</td>
</tr>
<tr class="even">
<td style="text-align: left;">FAMILY &amp; SUPPORT</td>
<td style="text-align: right;">625</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 2
# Groups:   department [36]
   department                  n
   &lt;chr&gt;                   &lt;int&gt;
 1 POLICE                  13055
 2 FIRE                     4833
 3 OEMC                     2121
 4 STREETS &amp; SAN            2045
 5 WATER MGMNT              1902
 6 AVIATION                 1414
 7 TRANSPORTN               1244
 8 PUBLIC LIBRARY            978
 9 FLEET AND FACILITY MGMT   964
10 FAMILY &amp; SUPPORT          625
# ℹ 26 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'department'</span>).agg(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  ttl_employees <span class="op">=</span> (<span class="st">'name'</span>, <span class="st">'count'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>).reset_index().sort_values(by<span class="op">=</span><span class="st">'ttl_employees'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 department  ttl_employees
27                   POLICE          13055
15                     FIRE           4833
26                     OEMC           2121
31            STREETS &amp; SAN           2045
34              WATER MGMNT           1902
2                  AVIATION           1414
32               TRANSPORTN           1244
30           PUBLIC LIBRARY            978
16  FLEET AND FACILITY MGMT            964
13         FAMILY &amp; SUPPORT            625
14                  FINANCE            563
17                   HEALTH            503
9              CITY COUNCIL            453
23                      LAW            392
6                 BUILDINGS            277
18       HOUSING &amp; ECON DEV            204
7          BUSINESS AFFAIRS            161
3         BOARD OF ELECTION            103
12                     DoIT             98
29              PROCUREMENT             97
21            INSPECTOR GEN             89
8                CITY CLERK             89
25           MAYOR'S OFFICE             86
1             ANIMAL CONTRL             80
20          HUMAN RESOURCES             71
10         CULTURAL AFFAIRS             67
5             BUDGET &amp; MGMT             46
0              ADMIN HEARNG             39
11             DISABILITIES             29
33                TREASURER             22
19          HUMAN RELATIONS             17
22                     IPRA             13
4           BOARD OF ETHICS              8
28             POLICE BOARD              2
24        LICENSE APPL COMM              1</code></pre>
</div>
</div>
<p><strong>Determine the highest salary in the dataset.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="fu">max</span>(salary_annual)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>1 records</caption>
<thead>
<tr class="header">
<th style="text-align: right;">max(salary_annual)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3e+05</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">max</span>(salary_annual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `max(salary_annual)`
                 &lt;dbl&gt;
1               300000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'salary_annual'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>np.float64(300000.0)</code></pre>
</div>
</div>
</section>
<section id="grouping-and-sorting" class="level1">
<h1>3. Grouping and Sorting:</h1>
<p><strong>List the average salary for each job title.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> title, <span class="fu">avg</span>(salary_annual) <span class="kw">as</span> avg_salary</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> title</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> avg_salary <span class="kw">desc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">avg_salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">COMMISSIONER OF AVIATION</td>
<td style="text-align: right;">300000</td>
</tr>
<tr class="even">
<td style="text-align: left;">SUPERINTENDENT OF POLICE</td>
<td style="text-align: right;">260004</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MAYOR</td>
<td style="text-align: right;">216210</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIRE COMMISSIONER</td>
<td style="text-align: right;">202728</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FIRST DEPUTY FIRE COMMISSIONER</td>
<td style="text-align: right;">197736</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIRST DEPUTY SUPERINTENDENT</td>
<td style="text-align: right;">197724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHIEF OF STAFF</td>
<td style="text-align: right;">195000</td>
</tr>
<tr class="even">
<td style="text-align: left;">DEPUTY FIRE COMMISSIONER</td>
<td style="text-align: right;">187680</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHIEF</td>
<td style="text-align: right;">185364</td>
</tr>
<tr class="even">
<td style="text-align: left;">ASST DEPUTY FIRE COMMISSIONER</td>
<td style="text-align: right;">185352</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_salary =</span> <span class="fu">mean</span>(salary_annual, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>avg_salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,121 × 2
   title                          avg_salary
   &lt;chr&gt;                               &lt;dbl&gt;
 1 COMMISSIONER OF AVIATION           300000
 2 SUPERINTENDENT OF POLICE           260004
 3 MAYOR                              216210
 4 FIRE COMMISSIONER                  202728
 5 FIRST DEPUTY FIRE COMMISSIONER     197736
 6 FIRST DEPUTY SUPERINTENDENT        197724
 7 CHIEF OF STAFF                     195000
 8 DEPUTY FIRE COMMISSIONER           187680
 9 CHIEF                              185364
10 ASST DEPUTY FIRE COMMISSIONER      185352
# ℹ 1,111 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'title'</span>).agg(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  avg_salary <span class="op">=</span> (<span class="st">'salary_annual'</span>, <span class="st">'mean'</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>).reset_index().sort_values(by<span class="op">=</span><span class="st">'avg_salary'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               title     avg_salary
252         COMMISSIONER OF AVIATION  300000.000000
997         SUPERINTENDENT OF POLICE  260004.000000
731                            MAYOR  216210.000000
516                FIRE COMMISSIONER  202728.000000
539   FIRST DEPUTY FIRE COMMISSIONER  197736.000000
...                              ...            ...
785                     POLICE CADET    9838.400000
828                     PROGRAM AIDE    9728.622222
1077       TITLE V PROGRAM TRAINEE I    8580.000000
576               FOSTER GRANDPARENT    2756.000000
915                 SENIOR COMPANION    2756.000000

[1121 rows x 2 columns]</code></pre>
</div>
</div>
<p><strong>Find the top 5 highest-paid departments.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> department, <span class="fu">avg</span>(salary_annual) <span class="kw">as</span> avg_salary</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> department</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> avg_salary <span class="kw">desc</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">limit</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>5 records</caption>
<thead>
<tr class="header">
<th style="text-align: left;">department</th>
<th style="text-align: right;">avg_salary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">IPRA</td>
<td style="text-align: right;">102758.77</td>
</tr>
<tr class="even">
<td style="text-align: left;">DoIT</td>
<td style="text-align: right;">99220.53</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BUILDINGS</td>
<td style="text-align: right;">99095.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIRE</td>
<td style="text-align: right;">98203.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BOARD OF ETHICS</td>
<td style="text-align: right;">95061.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_salary =</span> <span class="fu">mean</span>(salary_annual)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">5</span>, avg_salary) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>avg_salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  department      avg_salary
  &lt;chr&gt;                &lt;dbl&gt;
1 IPRA               102759.
2 DoIT                99221.
3 BUILDINGS           99096.
4 FIRE                98204.
5 BOARD OF ETHICS     95061 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'department'</span>).agg(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  avg_salary <span class="op">=</span> (<span class="st">'salary_annual'</span>, <span class="st">'mean'</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>).reset_index().sort_values(by<span class="op">=</span><span class="st">'avg_salary'</span>, ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         department     avg_salary
22             IPRA  102758.769231
12             DoIT   99220.530612
6         BUILDINGS   99095.580650
15             FIRE   98203.672849
4   BOARD OF ETHICS   95061.000000</code></pre>
</div>
</div>
<p><strong>Show the number of employees for each job title, ordered by the number of employees in descending order.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> title, <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> cnt_employees</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> title</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> cnt_employees <span class="kw">desc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">cnt_employees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: right;">9213</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIREFIGHTER-EMT</td>
<td style="text-align: right;">1492</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SERGEANT</td>
<td style="text-align: right;">1162</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLICE OFFICER (ASSIGNED AS DETECTIVE)</td>
<td style="text-align: right;">1015</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOTOR TRUCK DRIVER</td>
<td style="text-align: right;">709</td>
</tr>
<tr class="even">
<td style="text-align: left;">POOL MOTOR TRUCK DRIVER</td>
<td style="text-align: right;">693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SANITATION LABORER</td>
<td style="text-align: right;">634</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIREFIGHTER</td>
<td style="text-align: right;">533</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CROSSING GUARD</td>
<td style="text-align: right;">464</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONSTRUCTION LABORER</td>
<td style="text-align: right;">456</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,121 × 2
# Groups:   title [1,121]
   title                                      n
   &lt;chr&gt;                                  &lt;int&gt;
 1 POLICE OFFICER                          9213
 2 FIREFIGHTER-EMT                         1492
 3 SERGEANT                                1162
 4 POLICE OFFICER (ASSIGNED AS DETECTIVE)  1015
 5 MOTOR TRUCK DRIVER                       709
 6 POOL MOTOR TRUCK DRIVER                  693
 7 SANITATION LABORER                       634
 8 FIREFIGHTER                              533
 9 CROSSING GUARD                           464
10 CONSTRUCTION LABORER                     456
# ℹ 1,111 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'title'</span>).agg(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  cnt_employees <span class="op">=</span> (<span class="st">'name'</span>, <span class="st">'count'</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>).reset_index().sort_values(by<span class="op">=</span><span class="st">'cnt_employees'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      title  cnt_employees
791                          POLICE OFFICER           9213
529                         FIREFIGHTER-EMT           1492
946                                SERGEANT           1162
796  POLICE OFFICER (ASSIGNED AS DETECTIVE)           1015
744                      MOTOR TRUCK DRIVER            709
..                                      ...            ...
218                CHIEF SYSTEMS PROGRAMMER              1
220                     CHIEF WATER CHEMIST              1
221                    CHIEF WATER ENGINEER              1
222              CHIEF ZONING PLAN EXAMINER              1
0              1ST DEPUTY INSPECTOR GENERAL              1

[1121 rows x 2 columns]</code></pre>
</div>
</div>
</section>
<section id="joining-and-subqueries" class="level1">
<h1>4. Joining and Subqueries:</h1>
<p><strong>Retrieve the details of employees who have a salary in the top five of their department. Show the name, title, department, salary, and ranking.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> salary_by_dept_rank <span class="kw">as</span> (</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    name,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    title,</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    department,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    salary_annual,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span>(</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">partition</span> <span class="kw">by</span> department</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>      <span class="kw">order</span> <span class="kw">by</span> salary_annual <span class="kw">desc</span>) <span class="kw">as</span> salary_rank_by_department</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> department <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> salary_by_dept_rank</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> salary_rank_by_department <span class="op">&lt;=</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 34%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">department</th>
<th style="text-align: right;">salary_annual</th>
<th style="text-align: right;">salary_rank_by_department</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JACKOWIAK, PATRICIA</td>
<td style="text-align: left;">DIR OF ADMINISTRATIVE HEARINGS</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">156420</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">SHEELY, STEVEN N</td>
<td style="text-align: left;">DEPUTY DIR OF ADMINISTRATIVE ADJUDICATION</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">131688</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HENNIGAN, KEVIN G</td>
<td style="text-align: left;">FISCAL ADMINISTRATOR</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">117660</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">HEIDT, SANDRA E</td>
<td style="text-align: left;">ASST MANAGER OF ADMINISTRATIVE ADJUDICATION</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">98160</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GOGOLA, DEBORAH G</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">PARKER-OKOJIE, GABRIELLE E</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RIZZO, ANTHONY J</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">WEINERT, DARCI N</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RUSSELL, SUSAN J</td>
<td style="text-align: left;">EXECUTIVE DIR OF ANIMAL CARE AND CONTROL</td>
<td style="text-align: left;">ANIMAL CONTRL</td>
<td style="text-align: right;">130008</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">YAMAJI, PETER S</td>
<td style="text-align: left;">VETERINARIAN</td>
<td style="text-align: left;">ANIMAL CONTRL</td>
<td style="text-align: right;">128136</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">salary_rank =</span> <span class="fu">dense_rank</span>(<span class="fu">desc</span>(salary_annual))) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(department, salary_rank) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(salary_rank <span class="sc">&lt;=</span> <span class="dv">5</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">is.na</span>(department))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 290 × 9
# Groups:   department [35]
   name                       title department salary_annual original_hire_date 
   &lt;chr&gt;                      &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;dttm&gt;             
 1 JACKOWIAK,  PATRICIA       DIR … ADMIN HEA…        156420 1989-09-01 00:00:00
 2 SHEELY,  STEVEN N          DEPU… ADMIN HEA…        131688 2003-07-16 00:00:00
 3 HENNIGAN,  KEVIN G         FISC… ADMIN HEA…        117660 1980-01-07 00:00:00
 4 HEIDT,  SANDRA E           ASST… ADMIN HEA…         98160 1985-09-09 00:00:00
 5 GOGOLA,  DEBORAH G         SENI… ADMIN HEA…         96636 1989-10-02 00:00:00
 6 PARKER-OKOJIE,  GABRIELLE… SENI… ADMIN HEA…         96636 2004-06-15 00:00:00
 7 RIZZO,  ANTHONY J          SENI… ADMIN HEA…         96636 1997-12-08 00:00:00
 8 WEINERT,  DARCI N          SENI… ADMIN HEA…         96636 2003-03-17 00:00:00
 9 RUSSELL,  SUSAN J          EXEC… ANIMAL CO…        130008 2016-05-02 00:00:00
10 YAMAJI,  PETER S           VETE… ANIMAL CO…        128136 2000-08-21 00:00:00
# ℹ 280 more rows
# ℹ 4 more variables: start_date_in_present_position &lt;dttm&gt;,
#   salary_basis &lt;chr&gt;, employment_category &lt;chr&gt;, salary_rank &lt;int&gt;</code></pre>
</div>
</div>
<p><strong>Find the names of employees who earn more than the average salary in their department.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> dept_avg_salary <span class="kw">as</span> (</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">AVG</span>(salary_annual) <span class="kw">OVER</span>(</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>          <span class="kw">partition</span> <span class="kw">by</span> department) <span class="kw">as</span> avg_salary_by_department </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> department <span class="kw">IS</span> <span class="kw">NOT</span> <span class="kw">NULL</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> dept_avg_salary</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> salary_annual <span class="op">&gt;</span> avg_salary_by_department</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> department, salary_annual <span class="kw">desc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 21%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">department</th>
<th style="text-align: right;">salary_annual</th>
<th style="text-align: right;">original_hire_date</th>
<th style="text-align: right;">start_date_in_present_position</th>
<th style="text-align: left;">salary_basis</th>
<th style="text-align: left;">employment_category</th>
<th style="text-align: right;">avg_salary_by_department</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">JACKOWIAK, PATRICIA</td>
<td style="text-align: left;">DIR OF ADMINISTRATIVE HEARINGS</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">156420</td>
<td style="text-align: right;">620611200</td>
<td style="text-align: right;">1283299200</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">SHEELY, STEVEN N</td>
<td style="text-align: left;">DEPUTY DIR OF ADMINISTRATIVE ADJUDICATION</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">131688</td>
<td style="text-align: right;">1058313600</td>
<td style="text-align: right;">1309478400</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HENNIGAN, KEVIN G</td>
<td style="text-align: left;">FISCAL ADMINISTRATOR</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">117660</td>
<td style="text-align: right;">316051200</td>
<td style="text-align: right;">815184000</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">HEIDT, SANDRA E</td>
<td style="text-align: left;">ASST MANAGER OF ADMINISTRATIVE ADJUDICATION</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">98160</td>
<td style="text-align: right;">495072000</td>
<td style="text-align: right;">879465600</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GOGOLA, DEBORAH G</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">623289600</td>
<td style="text-align: right;">976924800</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">PARKER-OKOJIE, GABRIELLE E</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">1087257600</td>
<td style="text-align: right;">1497830400</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RIZZO, ANTHONY J</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">881539200</td>
<td style="text-align: right;">1095292800</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">WEINERT, DARCI N</td>
<td style="text-align: left;">SENIOR ADMINISTRATIVE LAW OFFICER</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">96636</td>
<td style="text-align: right;">1047859200</td>
<td style="text-align: right;">1468627200</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RIZZO, MARGARET A</td>
<td style="text-align: left;">ADMINISTRATIVE SERVICES OFFICER II EXCLD</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">93300</td>
<td style="text-align: right;">173404800</td>
<td style="text-align: right;">1164931200</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">SMITH, PAMELA M</td>
<td style="text-align: left;">ASST TO THE EXEC DIR</td>
<td style="text-align: left;">ADMIN HEARNG</td>
<td style="text-align: right;">93300</td>
<td style="text-align: right;">585187200</td>
<td style="text-align: right;">991353600</td>
<td style="text-align: left;">SALARY</td>
<td style="text-align: left;">Fulltime-Regular</td>
<td style="text-align: right;">78894.15</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_salary =</span> <span class="fu">mean</span>(salary_annual)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(salary_annual <span class="sc">&gt;</span> avg_salary) <span class="sc">%&gt;%</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(department, <span class="sc">-</span>salary_annual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16,399 × 9
# Groups:   department [35]
   name                       title department salary_annual original_hire_date 
   &lt;chr&gt;                      &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;dttm&gt;             
 1 JACKOWIAK,  PATRICIA       DIR … ADMIN HEA…        156420 1989-09-01 00:00:00
 2 SHEELY,  STEVEN N          DEPU… ADMIN HEA…        131688 2003-07-16 00:00:00
 3 HENNIGAN,  KEVIN G         FISC… ADMIN HEA…        117660 1980-01-07 00:00:00
 4 HEIDT,  SANDRA E           ASST… ADMIN HEA…         98160 1985-09-09 00:00:00
 5 GOGOLA,  DEBORAH G         SENI… ADMIN HEA…         96636 1989-10-02 00:00:00
 6 PARKER-OKOJIE,  GABRIELLE… SENI… ADMIN HEA…         96636 2004-06-15 00:00:00
 7 RIZZO,  ANTHONY J          SENI… ADMIN HEA…         96636 1997-12-08 00:00:00
 8 WEINERT,  DARCI N          SENI… ADMIN HEA…         96636 2003-03-17 00:00:00
 9 RIZZO,  MARGARET A         ADMI… ADMIN HEA…         93300 1975-07-01 00:00:00
10 SMITH,  PAMELA M           ASST… ADMIN HEA…         93300 1988-07-18 00:00:00
# ℹ 16,389 more rows
# ℹ 4 more variables: start_date_in_present_position &lt;dttm&gt;,
#   salary_basis &lt;chr&gt;, employment_category &lt;chr&gt;, avg_salary &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'avg_salary'</span>] <span class="op">=</span> df[<span class="st">'salary_annual'</span>].mean()</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>df[df[<span class="st">'salary_annual'</span>] <span class="op">&gt;</span> df[<span class="st">'avg_salary'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        name  ...    avg_salary
0          AARON,  JEFFERY M  ...  81631.458876
1             AARON,  KARINA  ...  81631.458876
2        AARON,  KIMBERLEI R  ...  81631.458876
3        ABAD JR,  VICENTE M  ...  81631.458876
7      ABBATACOLA,  ROBERT J  ...  81631.458876
...                      ...  ...           ...
32797       ZYGADLO,  JOHN P  ...  81631.458876
32798    ZYGADLO,  MICHAEL J  ...  81631.458876
32803      ZYMANTAS,  MARK E  ...  81631.458876
32804    ZYRKOWSKI,  CARLO E  ...  81631.458876
32805    ZYSKOWSKI,  DARIUSZ  ...  81631.458876

[19902 rows x 9 columns]</code></pre>
</div>
</div>
</section>
<section id="complex-queries" class="level1">
<h1>5. Complex Queries:</h1>
<p><strong>Calculate the percentage of employees in each department relative to the total number of employees.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> dept_employees <span class="kw">as</span> (</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> department, <span class="fu">count</span>(<span class="op">*</span>) cnt_employees</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> df</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">group</span> <span class="kw">by</span> department</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>ttl_employees <span class="kw">as</span> (</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">select</span> <span class="fu">count</span>(<span class="op">*</span>) <span class="kw">as</span> ttl_count</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">from</span> df</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span>, <span class="fu">round</span>(cnt_employees <span class="op">*</span> <span class="fl">100.0</span> <span class="op">/</span> ttl_count, <span class="dv">1</span>) <span class="kw">as</span> pct_employees</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> dept_employees, ttl_employees</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> pct_employees <span class="kw">desc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">department</th>
<th style="text-align: right;">cnt_employees</th>
<th style="text-align: right;">ttl_count</th>
<th style="text-align: right;">pct_employees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">13055</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">39.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIRE</td>
<td style="text-align: right;">4833</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">14.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OEMC</td>
<td style="text-align: right;">2121</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">6.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">STREETS &amp; SAN</td>
<td style="text-align: right;">2045</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WATER MGMNT</td>
<td style="text-align: right;">1902</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">5.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">AVIATION</td>
<td style="text-align: right;">1414</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">4.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TRANSPORTN</td>
<td style="text-align: right;">1244</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">3.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">PUBLIC LIBRARY</td>
<td style="text-align: right;">978</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">3.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FLEET AND FACILITY MGMT</td>
<td style="text-align: right;">964</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">2.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">FAMILY &amp; SUPPORT</td>
<td style="text-align: right;">625</td>
<td style="text-align: right;">32806</td>
<td style="text-align: right;">1.9</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(department) <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ttl_employees =</span> <span class="fu">sum</span>(n),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">pct_employees =</span> <span class="fu">round</span>((n <span class="sc">/</span> ttl_employees) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>pct_employees)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 36 × 4
   department                  n ttl_employees pct_employees
   &lt;chr&gt;                   &lt;int&gt;         &lt;int&gt;         &lt;dbl&gt;
 1 POLICE                  13055         32806          39.8
 2 FIRE                     4833         32806          14.7
 3 OEMC                     2121         32806           6.5
 4 STREETS &amp; SAN            2045         32806           6.2
 5 WATER MGMNT              1902         32806           5.8
 6 AVIATION                 1414         32806           4.3
 7 TRANSPORTN               1244         32806           3.8
 8 PUBLIC LIBRARY            978         32806           3  
 9 FLEET AND FACILITY MGMT   964         32806           2.9
10 FAMILY &amp; SUPPORT          625         32806           1.9
# ℹ 26 more rows</code></pre>
</div>
</div>
<p><strong>Identify job titles that have more than 100 employees.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> title, <span class="fu">count</span>(<span class="op">*</span>) cnt_employees</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> df</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="kw">group</span> <span class="kw">by</span> title</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="kw">having</span> cnt_employees <span class="op">&gt;</span> <span class="dv">100</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> cnt_employees <span class="kw">desc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: left;">title</th>
<th style="text-align: right;">cnt_employees</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: right;">9213</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIREFIGHTER-EMT</td>
<td style="text-align: right;">1492</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SERGEANT</td>
<td style="text-align: right;">1162</td>
</tr>
<tr class="even">
<td style="text-align: left;">POLICE OFFICER (ASSIGNED AS DETECTIVE)</td>
<td style="text-align: right;">1015</td>
</tr>
<tr class="odd">
<td style="text-align: left;">MOTOR TRUCK DRIVER</td>
<td style="text-align: right;">709</td>
</tr>
<tr class="even">
<td style="text-align: left;">POOL MOTOR TRUCK DRIVER</td>
<td style="text-align: right;">693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SANITATION LABORER</td>
<td style="text-align: right;">634</td>
</tr>
<tr class="even">
<td style="text-align: left;">FIREFIGHTER</td>
<td style="text-align: right;">533</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CROSSING GUARD</td>
<td style="text-align: right;">464</td>
</tr>
<tr class="even">
<td style="text-align: left;">CONSTRUCTION LABORER</td>
<td style="text-align: right;">456</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 46 × 2
# Groups:   title [46]
   title                                      n
   &lt;chr&gt;                                  &lt;int&gt;
 1 POLICE OFFICER                          9213
 2 FIREFIGHTER-EMT                         1492
 3 SERGEANT                                1162
 4 POLICE OFFICER (ASSIGNED AS DETECTIVE)  1015
 5 MOTOR TRUCK DRIVER                       709
 6 POOL MOTOR TRUCK DRIVER                  693
 7 SANITATION LABORER                       634
 8 FIREFIGHTER                              533
 9 CROSSING GUARD                           464
10 CONSTRUCTION LABORER                     456
# ℹ 36 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">'title'</span>).agg(</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  cnt_title <span class="op">=</span> (<span class="st">'title'</span>, <span class="st">'count'</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>).reset_index().sort_values(by<span class="op">=</span><span class="st">'cnt_title'</span>, ascending<span class="op">=</span><span class="va">False</span>).query(<span class="st">'cnt_title &gt; 100'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                       title  cnt_title
791                           POLICE OFFICER       9213
529                          FIREFIGHTER-EMT       1492
946                                 SERGEANT       1162
796   POLICE OFFICER (ASSIGNED AS DETECTIVE)       1015
744                       MOTOR TRUCK DRIVER        709
808                  POOL MOTOR TRUCK DRIVER        693
899                       SANITATION LABORER        634
525                              FIREFIGHTER        533
326                           CROSSING GUARD        464
280                     CONSTRUCTION LABORER        456
1079             TRAFFIC CONTROL AIDE-HOURLY        452
680                           LIEUTENANT-EMT        425
679                               LIEUTENANT        379
327                 CROSSING GUARD - PER CBA        348
760                                PARAMEDIC        341
762                            PARAMEDIC I/C        278
598                    GENERAL LABORER - DSS        258
531                    FIREFIGHTER/PARAMEDIC        255
530                FIREFIGHTER-EMT (RECRUIT)        252
140                AVIATION SECURITY OFFICER        236
786         POLICE COMMUNICATIONS OPERATOR I        236
617                        HOISTING ENGINEER        233
520                        FIRE ENGINEER-EMT        231
452                      ELECTRICAL MECHANIC        229
360                           DETENTION AIDE        224
801        POLICE OFFICER / FLD TRNG OFFICER        219
787        POLICE COMMUNICATIONS OPERATOR II        215
752               OPERATING ENGINEER-GROUP A        186
676                             LIBRARY PAGE        166
753               OPERATING ENGINEER-GROUP C        166
689                   MACHINIST (AUTOMOTIVE)        160
576                       FOSTER GRANDPARENT        143
162                              CAPTAIN-EMT        140
277                         CONCRETE LABORER        139
15                    ADMINISTRATIVE ASST II        132
649                                  LABORER        130
783              POLICE ADMINISTRATIVE CLERK        128
918               SENIOR DATA ENTRY OPERATOR        124
780                                  PLUMBER        123
978                               STAFF ASST        121
666                              LIBRARIAN I        121
52                           ASPHALT LABORER        110
979               STAFF ASST TO THE ALDERMAN        107
17                   ADMINISTRATIVE ASST III        107
519                            FIRE ENGINEER        106
764                 PARKING ENFORCEMENT AIDE        106</code></pre>
</div>
</div>
<p><strong>Find employees who have been in their current position for more than 5 years (assuming the dataset includes a hire date or a similar field).</strong></p>
<p><em>Note: need to do some more research on the <code>DBI::</code> package, as the SQL object is reading date fields in as a dbl data type.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tenure =</span> <span class="fu">round</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    lubridate<span class="sc">::</span><span class="fu">time_length</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">today</span>() <span class="sc">-</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(start_date_in_present_position), <span class="st">"year"</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tenure <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>tenure)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32,806 × 9
   name                title        department salary_annual original_hire_date 
   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt; &lt;dttm&gt;             
 1 LANNON,  JOHN P     CONSTRUCTIO… WATER MGM…        83616  1963-07-02 00:00:00
 2 WILLIAMS,  DAISY    CROSSING GU… OEMC              23254. 1965-12-06 00:00:00
 3 CALHOUN,  ROCKELL H CROSSING GU… OEMC              23254. 1968-03-25 00:00:00
 4 SCOTT,  ROSIE M     PARKING ENF… FINANCE           64392  1968-08-19 00:00:00
 5 BURKE,  CATHERINE   CROSSING GU… OEMC              23254. 1970-05-13 00:00:00
 6 BISHOP,  DORIS J    LIBRARY ASS… PUBLIC LI…        69492  1971-09-07 00:00:00
 7 LUMPKIN,  STEPHEN   SANITATION … STREETS &amp;…        75317. 1972-03-11 00:00:00
 8 KUCHARSKI,  JOYCE M CROSSING GU… OEMC              23254. 1973-09-17 00:00:00
 9 CORSO JR,  JOHN J   PROPERTY CU… POLICE            70092  1975-05-27 00:00:00
10 PHILLIPS,  EUGENIA  CROSSING GU… OEMC              23254. 1976-01-12 00:00:00
# ℹ 32,796 more rows
# ℹ 4 more variables: start_date_in_present_position &lt;dttm&gt;,
#   salary_basis &lt;chr&gt;, employment_category &lt;chr&gt;, tenure &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="own-questions" class="level1">
<h1>6. Own Questions</h1>
<p><strong>Pull the second title of all employees that have been promoted at least once.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">with</span> promotion_seq <span class="kw">as</span> (</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>      <span class="kw">select</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>          name,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>          title,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>          department,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>          start_date_in_present_position,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span>(</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>            <span class="kw">partition</span> <span class="kw">by</span> name</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>            <span class="kw">order</span> <span class="kw">by</span> start_date_in_present_position</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>          ) <span class="kw">as</span> seq_promotion</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>      <span class="kw">from</span> df</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="kw">select</span> <span class="op">*</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="kw">from</span> promotion_seq</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="kw">where</span> seq_promotion <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="kw">order</span> <span class="kw">by</span> name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Displaying records 1 - 10</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 30%">
<col style="width: 18%">
<col style="width: 24%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">title</th>
<th style="text-align: left;">department</th>
<th style="text-align: right;">start_date_in_present_position</th>
<th style="text-align: right;">seq_promotion</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ADE, JAMES P</td>
<td style="text-align: left;">POLICE OFFICER</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">1283299200</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANDERSON, DAVID C</td>
<td style="text-align: left;">PROJECTS ADMINISTRATOR</td>
<td style="text-align: left;">BUILDINGS</td>
<td style="text-align: right;">1393200000</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ANDERSON, DONALD</td>
<td style="text-align: left;">PROJECT MANAGER</td>
<td style="text-align: left;">AVIATION</td>
<td style="text-align: right;">1494806400</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ANDERSON, RHONDA M</td>
<td style="text-align: left;">SERGEANT</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">1464739200</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ARROYO, FRANCISCO</td>
<td style="text-align: left;">WARD SUPERINTENDENT</td>
<td style="text-align: left;">STREETS &amp; SAN</td>
<td style="text-align: right;">1489622400</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ATECA, SALVADOR R</td>
<td style="text-align: left;">MACHINIST (AUTOMOTIVE)</td>
<td style="text-align: left;">FLEET AND FACILITY MGMT</td>
<td style="text-align: right;">1425340800</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIANCHI, MICHAEL J</td>
<td style="text-align: left;">FIRE COMMUNICATIONS OPERATOR I</td>
<td style="text-align: left;">OEMC</td>
<td style="text-align: right;">1502841600</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">BRACKEN, DANIEL J</td>
<td style="text-align: left;">PARAMEDIC</td>
<td style="text-align: left;">FIRE</td>
<td style="text-align: right;">1418688000</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BROWN, ANTHONY</td>
<td style="text-align: left;">GENERAL LABORER - DSS</td>
<td style="text-align: left;">STREETS &amp; SAN</td>
<td style="text-align: right;">1405296000</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">BROWN, PATRICK J</td>
<td style="text-align: left;">POLICE OFFICER (ASSIGNED AS DETECTIVE)</td>
<td style="text-align: left;">POLICE</td>
<td style="text-align: right;">1429142400</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(start_date_in_present_position) <span class="sc">%&gt;%</span> </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">seq_promotion =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(seq_promotion <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 284 × 9
# Groups:   name [284]
   name                title        department salary_annual original_hire_date 
   &lt;chr&gt;               &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt; &lt;dttm&gt;             
 1 ADE,  JAMES P       POLICE OFFI… POLICE            84054  2010-09-01 00:00:00
 2 ANDERSON,  DAVID C  PROJECTS AD… BUILDINGS         94824  2014-02-24 00:00:00
 3 ANDERSON,  DONALD   PROJECT MAN… AVIATION          80868  1987-08-04 00:00:00
 4 ANDERSON,  RHONDA M SERGEANT     POLICE           104628  2000-02-28 00:00:00
 5 ARROYO,  FRANCISCO  WARD SUPERI… STREETS &amp;…        73212  2015-05-18 00:00:00
 6 ATECA,  SALVADOR R  MACHINIST (… FLEET AND…        96408  2015-03-03 00:00:00
 7 BIANCHI,  MICHAEL J FIRE COMMUN… OEMC              51264  2017-08-16 00:00:00
 8 BRACKEN,  DANIEL J  PARAMEDIC    FIRE              76266  2014-12-16 00:00:00
 9 BROWN,  ANTHONY     GENERAL LAB… STREETS &amp;…        43202. 2014-07-14 00:00:00
10 BROWN,  PATRICK J   POLICE OFFI… POLICE            97440  1999-03-08 00:00:00
# ℹ 274 more rows
# ℹ 4 more variables: start_date_in_present_position &lt;dttm&gt;,
#   salary_basis &lt;chr&gt;, employment_category &lt;chr&gt;, seq_promotion &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">'start_date_in_present_position'</span>).groupby(<span class="st">'name'</span>).<span class="bu">apply</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">lambda</span> x: x.assign(seq_promotion<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(x) <span class="op">+</span> <span class="dv">1</span>))).query(<span class="st">'seq_promotion == 2'</span>).reset_index(drop<span class="op">=</span><span class="va">True</span>).sort_values(by<span class="op">=</span><span class="st">'name'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;string&gt;:1: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
                    name  ... seq_promotion
0          ADE,  JAMES P  ...             2
1     ANDERSON,  DAVID C  ...             2
2      ANDERSON,  DONALD  ...             2
3    ANDERSON,  RHONDA M  ...             2
4     ARROYO,  FRANCISCO  ...             2
..                   ...  ...           ...
279    WILSON,  EDWARD J  ...             2
280    WILSON,  JANICE L  ...             2
281      WILSON,  JOHN L  ...             2
282      WILSON,  JOSHUA  ...             2
283  WRONOWSKI,  JAMES J  ...             2

[284 rows x 10 columns]</code></pre>
</div>
</div>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p><strong>This project had three purposes:</strong></p>
<ol type="1">
<li><p><strong>To show how to run R, SQL, and Python all interchangeably in a Quarto document.</strong> Quarto and the <code>reticulate::</code> and <code>DBI::</code> packages allow for the functionality to switch between different methods of handling, querying, and analyzing data. Practically speaking, you probably wouldn’t switch between these as often as I did in this work, but it’s useful to verify your work and could come in handy for specific circumstances (e.g.&nbsp;analyzing with Pandas and visualizing with ggplot2). I did find that some of the work in SQL is clunky – data types didn’t read in correctly for dates – but I have not yet dug more deeply into the <code>DBI::</code> package to troubleshoot.</p></li>
<li><p><strong>To compare the ease of writing code using dplyr (R), SQL, and pandas (Python).</strong> Personally, I feel that R and <code>dplyr::</code> is the simplest syntax to use, followed by SQL and Python. <code>dplyr::</code> is very linear in its construction, and it rarely has extra characters to remember. Python’s brackets, quotes, and chaining all take some getting used to, while R and SQL feel more direct.</p></li>
<li><p><strong>To include some demonstration of SQL in my portfolio (which is often not included but remains a critical skill).</strong> This was a fun way to demonstrate some SQL expertise while comparing and verifying output against R and Python.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>